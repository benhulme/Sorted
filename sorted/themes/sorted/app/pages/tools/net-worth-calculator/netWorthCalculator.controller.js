!function(){"use strict";angular.module("sorted").controller("NetWorthCalculatorController",["$scope","siteConfig","NetWorthCalculatorModel","$window","$routeParams","isLoggedIn","pageData","calcData","$analytics",function(t,a,e,r,o,s,c,l,n){function u(a){function e(t){var a=(new Date).getFullYear();return parseInt(t)?new Date(a+parseInt(t)).getFullYear():a}function r(t){if(0!==t.result.get("sum_total")||0!==t.result.get("debt_total")){s.push(t.result.get("total")),c.push(t.result.get("sum_total")),l.push(parseInt(t.result.get("debt_total")*-1));var a=t.get("identifier");n.push(e(a))}}var o=t.model.hasResult(),s=[],c=[],l=[],n=[],u=_.merge({},{categories:_.map([0,10,20],function(t){return e(t.value)})},{assets:a.dummyData.assets},{debts:a.dummyData.debts},{netWorth:[_.add(a.dummyData.assets[0],a.dummyData.debts[0]),_.add(a.dummyData.assets[1],a.dummyData.debts[1]),_.add(a.dummyData.assets[2],a.dummyData.debts[2])]});t.model.collection.forEach(function(t){r(t)});var i=_.merge({},a.options);return i.categoryAxis.categories=o?n:u.categories,_.merge(i,{series:[_.merge({},{data:o?c:u.assets,stack:"Savings/Debts",name:"Assets",color:"#20d4af"}),_.merge({},{data:o?l:u.debts,stack:"Savings/Debts",name:"Liabilities",color:"#ce0058"}),_.merge({},{data:o?s:u.netWorth,stack:"Total",name:"Your net worth",color:"#00afff"})]}),i}t.siteConfig=a,t.data=c.data[0],t.calculator=l.data,t.model=function(){var a=[],o=new r.SortedCalculator_Net_Worth;return _.forEach(t.calculator.models,function(t){var e={};_.forEach(t.fields,function(t){t.calcModel&&(e[t.calcModel]=t.value)}),_.merge(e,_.pick(t,["unique","identifier","id"])),a.push(e)}),new e({models:a,CalcID:t.calculator.CalcID},{parse:!0,calculator:o})}(),t.resultsInteraction=!1,t.interaction=!1,t.hasResult=function(){return t.model.hasResult()},t.$broadcast("chart:draw",u(_.cloneDeep(t.calculator.chart))),t.model.collection.on("change",function(a){t.interaction||(n.eventTrack("startinteraction",{category:"calculators",label:"networth"}),t.interaction=!0),a.calculate().hasResult()&&(t.resultsInteraction||(n.eventTrack("resultscalculated",{category:"calculators",label:"networth"}),t.resultsInteraction=!0),t.$broadcast("chart:draw",u(_.cloneDeep(t.calculator.chart))))}),_.has(o,"id")&&s&&t.model.set("ID",o.id).fetch({parse:!0,success:function(t,a,e){console.info("success: ",t,a,e)},error:function(t,a,e){console.error("error: ",t,a,e)}}),t.$on("chart:ready",function(){t.$broadcast("chart:draw",u(t.calculator.chart))})}])}();