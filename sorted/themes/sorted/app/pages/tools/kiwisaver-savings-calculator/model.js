angular.module("sorted").factory("KiwiSaverSavingsModel",["siteConfig","NgBackboneModel",function(t,e){"use strict";var r=e.extend({hasResult:function(){var t=this,e=["retirement_lump_sum","retirement_income","years_3","years_5"];return!!_.reduce(t.pick(e),function(t,e){return _.isNull(e)?t:_.add(t,parseInt(e))},0)}});return e.extend({idAttribute:"ID",intAttrs:[],floatAttrs:[],dateAttrs:[],defaults:{Title:"KiwiSaver savings calculator"},urlRoot:t.API_PREFIX,url:function(){var t=this.urlRoot+"/rest/tool";return this.isNew()?t:t+"/"+this.get("ID")},initialize:function(){this.result=new r,this.on("change:gender",function(){2===this.get("gender")?this.set("life_expectancy",91):1===this.get("gender")&&this.set("life_expectancy",94)})},parse:function(t,e){var r=this,s={},i={},a=e||{};return s=_.has(t,"status")&&_.has(t,"data")?_.merge(_.cloneDeep(t.data.Data),_.pick(t.data,"ID")):t,_.has(s.result,"result")&&r.result.set(_.pick(s,"result"),a),_.forEach(s,function(t,e){r.intAttrs.indexOf(e)>-1?i[e]=r._toInt(t):r.floatAttrs.indexOf(e)>-1?i[e]=r._toFloat(t):r.dateAttrs.indexOf(e)>-1?i[e]=r._toDate(t):i[e]=t}),_.omit(i,["result"])},calculate:function(t){var e=t.calculate(_.clone(this.attributes));return e?this.result.set(e):this.result.clear(),this},hasResult:function(){return this.result.hasResult()},saveResult:function(){var t={parse:!0};return this.save(null,t)},toJSON:function(){var t=e.prototype.toJSON.apply(this,arguments);return _.merge(t,{result:this.result.toJSON()}),_.merge({Data:t},_.pick(t,"CalcID","Title"))}})}]);