{"version":3,"sources":["scripts/app.js"],"names":["Budget","colourGenerator","scope","this","angular","module","PagedataParser","$log","toastr","BudgetTemplateParser","fromDatabase","obj","returnObj","welcome","Header","Title","budget-template","parsePageData","budgeting-tool","service","$inject","Content","Questions","List","MasterCategories","i","length","question","push","parseQuestion","parseMasterCategory","masterCategory","ID","Color","Categories","Filename","parseSubCategory","subCategory","Default","Question","TemplateColor","Buttons","Toggle","ToggleSelectDefault","button","CategoryId","Icon","getDefaultSubCategories","availableMasterCategories","defaultSubCategories","availableMasterCategory","j","availableCategory","associateCategoriesWithMasterCategories","categoriesArray","defaultPeriod","tempSelectedCategories","masterCategoriesObj","k","undefined","PieValuePercent","ValueCents","ValueFormattedString","DisplayOpen","SubCategories","newSubCategory","MasterCategoryID","Image","masterCategories","forEach","value","key","console","log","BudgetCalculator","$http","$location","factory","current","prototype","instance","changeSinceSave","create","title","Income","Streams","TotalCents","updateBudgetPeriod","period","Period","addIncomeStream","cents","removeable","formatCents","centsToValueFormattedString","Cents","CentsFormattedString","Removable","totalCents","parseInt","TotalFormattedString","deleteIncomeStream","index","splice","strDollarsToCents","str","parseFloat","replace","guid","s4","Math","floor","random","toString","substring","valueInCents","round","t","toFixed","valueFormattedString","addInitialCategories","categories","addNewMasterCategory","masterCategoryTitle","newMasterCategory","getNextColour","getCategories","deleteSubCategoryByIndex","masterCategoryIndex","subCategoryIndex","calculateValues","addNewSubCategoryToMasterCategory","masterCategoryId","imagePath","tempObj","copy","updateSubCategoryByIndex","cat","setBudgetView","view","PreferredView","getBudgetView","parseForUpload","cloneObj","JSON","parse","stringify","deleteMasterCategotyByID","masterCategoryID","foundAt","updateMasterCategoryTitle","masterCat","getMasterCategoryById","incomeStreamsTotal_FormattedString","IncomeStreams","IncomePeriod","incomeStreams_TotalCents","stream","masterCategories_FormattedString","masterCategories_TotalCents","masterCategoryTotalCents","amountCents","thisCents","dividedByTotal","MasterCategoriesTotalCents","MasterCategoriesTotalFormattedString","LeftToBudget","isNaN","math","convert","oldPeriod","newPeriod","eq","div","PerYear","times","displayDollars","toNumber","perYear","budget","displayCategoryDollars","toolHeader","siteConfig","ToolheaderController","$uibModal","profileApi","$scope","$rootScope","Api","vm","TOOL_ASSETS","imagepath","$watch","userLogged","isLoggedIn","then","response","getProfile","newValue","onSave_clickHandler","ev","preventDefault","parseObj","saveBudget","directive","restrict","templateUrl","data","profiledata","budgetdata","breadcrumbs","controller","controllerAs","TimeoutModalController","SiteData","$uibModalInstance","categoryData","activate","onCancel_clickHandler","close","MultiBudgetModalController","editDate","getLastEditDate","onOverWrite_clickHandler","modalActivator","ModalType","linkFunc","el","attr","addListeners","modalType","EDIT_BUDGET","addClass","on","onEditBudget_clickHandler","DELETE_SUBCATEGORY","onDeleteSubCategory_clickHandler","ADD_SUBCATEGORY","onAddSubCategory_clickHandler","EDIT_MASTER_CATEGORY","onEditMasterCat_clickHandler","DELETE_MASTER_CATEGORY","onDeleteMasterCat_clickHandler","masterData","subCatData","masterElData","subCatElData","isDefined","masterCategoryData","masterCatId","categoryIndex","open","size","resolve","mastercategoryData","subcategoryData","subCatId","categoryTitle","subCategoryId","modalInstance","result","$broadcast","$on","ModalactivatorController","link","EditMasterCatModalController","budgetingToolConfig","iconSrc","catColor","catId","icon","onOk_clickHandler","onDelete_clickHandler","EditBudgetModalController","userProfileData","Profile","ImageSource","startCalc","budgetCalculator","budgetPeriods","BUDGET_PERIODS","onRemoveIncome_clickHandler","streamModel","onAddIncome_clickHandler","onUpdateStream_blurHandler","tempVal","onSetBudgetPeriod_clickHandler","event","args","DeleteSubCategoryController","$uibModalStack","subCategoryTitle","dismissAll","DeleteMasterCategoryController","AddEditSubCategoryController","$timeout","Upload","initialPeriod","DEFAULT_BUDGET_PERIOD","uploadProgress","isUploading","isEdit","newCategory","resp","File","upload","files","file","url","getUploadURL","$error","imageURL","evt","progressPercentage","loaded","total","onSetPeriod_clickHandler","tempPeriod","createCategory","numValid","maxValid","updateCategory","onCategoryName_keyUpHandler","defaultPrevented","handled","which","keyIdentifier","keyCode","introHeader","IntroheaderController","moment","BreadcrumbsController","WelcomeController","path","search","get","error","next","setIsNewBudget","budgetAmountForm","$valid","element","parent","removeClass","ToolController","$window","BudgetView","updateChartData","chartData","temp","isZeroed","color","tinycolor","setAlpha","category","dollars","toRgbString","chartOptions","dataSource","kendo","DataSource","salary","BREAKDOWN_CHART_OPTIONS","currentBudget","viewState","breakdownCollapse","isReady","showMobileBudget","localNewBudget","getIsNewBudget","loadBudget","getBudgetData","chartRefresh","onToggleMobileBudget_clickHandler","subCategoryModel","PopoverOpen","onMasterCategoryCancel_clickHandler","onMasterCategoryInput_keyUpHandler","onMaterCategoryEdit_clickHandler","onMasterCategorySave_clickHandler","onViewToggle_clickHandler","viewTo","onMasterCategory_clickHandler","masterCategoryObj","onBreakdownToggle_clickHandler","onSubCategoryTitle_focusInHandler","subCategoryObj","stateEdit","onSubCategoryTitle_focusOutHandler","onSubCategoryValue_focusInHandler","convertToFloat","isItNaN","onSubCategoryValue_focusOutHandler","onSubCategoryTitle_keyUpHandler","currentTarget","blur","showSaveWaring","onExit","e","document","getElementsByClassName","scrollIntoView","startApp","err","hasAccessedTool","onbeforeunload","budgetData","preferredView","$cookies","$q","profile","setDomain","domain","host","BASE_URL","method","success","reject","uploadBudgetImage","image","formData","FormData","append","transformRequest","identity","headers","Content-Type","DOMAIN","API_PREFIX","lastEditedDate","isNewBudget","isNew","request","budgetsArr","Data","Date","LastEdited","budgetId","parsedObj","forceSave","showWarning","cleanObj","sendData","CalcID","post","status","get_SiteData","restrictCurrency","on_keyPressHandler","on_keyUpHandler","on_blurHandler","strToFloat","$input","$","trigger","on_focusHandler","preventInputZoom","className","classList","remove","APP_NAME","APP_VERSION","APP_PATH","DATE_FORMAT","GTM_PAGEVIEW_VARIABLE","GTM_CUSTOM_EVENT_NAME","Colors","fadeColour","colour","fraction","components","match","_","map","n","colourComponent","whiteComponent","join","hexToRgba","opacity","_baseColour","COLOUR_SET","_gradient","COLOUR_GRADIENTS","getStartColour","page","deferred","defer","siteData","promise","constant","ALERT_TIMEOUT","chartArea","height","width","margin","padding","transitions","legend","visible","series","field","overlay","gradient","seriesDefaults","type","startAngle","legendItemClick","legendItemHover","tooltip","animation","duration","template","BREAKDOWN_CHART_SPACER","BROWSER_CLOSE_WARNING","Shortname","BUDGETING_TOOL_PREFIX","BUDGETING_TOOL_PATH","BUDGETING_TOOL_IMAGE_PATH","CALC_ID","CATEGORY_IMAGE_TYPES","CATEGORY_TITLE_PLACEHOLDER","DEFAULT_BUDGET_TITLE","DEFAULT_BUDGET_VIEW","IE_MAX_SAFE_INTEGER","INCOME_STREAM_PLACEHOLDER","LOGIN_REMINDER_TIMEOUT","MAX_CATEGORY_TITLE","MAX_CATEGORY_TITLE_FIELD","MAX_STREAMS","VIEW_TEMPLATES","grid","plateTitle","plateIcon","list","BudgettemplateController","setDataDefaults","ButtonOptions","isSelected","onSkip_clickHandler","submitForm","useOnlyDefaults","viewTypeIndex","defaultCategories","tempButtonsList","concat","GRID","LIST","unique","filter","item","pos","indexOf","onQuestion_clickHandler","preset","runBlock","run","routeConfig","$routeProvider","when","otherwise","redirectTo","config","malarkey","LOGIN","$logProvider","toastrConfig","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","$templateCache","put"],"mappings":"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","file":"scripts/app.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool',\n      ['ngAnimate',\n        'ngCookies',\n        'ngTouch',\n        'ngSanitize',\n        'ngMessages',\n        'ngAria',\n        'ngResource',\n        'ngRoute',\n        'ui.bootstrap',\n        'toastr',\n        'ngFileUpload',\n        'kendo.directives'\n      ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .service('PagedataParser', PagedataParser);\n\n  /** @ngInject */\n  function PagedataParser($log,\n                          toastr,\n                          BudgetTemplateParser)\n  {\n\n\n    function fromDatabase(obj)\n    {\n      var returnObj = {\n        welcome : {\n          Header : {\n            Title : obj['welcome']['Header']['Title']\n          },\n\n        },\n        'budget-template' : BudgetTemplateParser.parsePageData(obj['budget-template']),\n        'budgeting-tool' : {\n\n        }\n      }\n\n      return returnObj;\n    }\n\n    var service = {\n      fromDatabase : fromDatabase\n    };\n\n    return service;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .service('BudgetTemplateParser', BudgetTemplateParser);\n\n  /** @ngInject */\n  function BudgetTemplateParser($log,\n                          toastr)\n  {\n\n    function parsePageData(obj)\n    {\n      var returnObj = {\n        Header: {\n          Title: obj['Header']['Title'],\n          Content: obj['Header']['Content']\n        },\n        Questions: {\n          List: []\n        },\n        MasterCategories : []\n      }\n\n      // Parse the questions\n      for(var i = 0; i < obj['Questions']['List'].length; i++)\n      {\n        var question = obj['Questions']['List'][i];\n        returnObj.Questions.List.push(parseQuestion(question));\n      }\n\n      // Parse the master categories\n      for(var i = 0; i < obj['MasterCategories'].length; i++)\n      {\n        returnObj.MasterCategories.push(parseMasterCategory(obj['MasterCategories'][i]));\n      }\n\n      return returnObj;\n    }\n\n    function parseMasterCategory(obj)\n    {\n      var masterCategory = {\n        ID : obj['ID'],\n        Title : obj['Title'],\n        Color : obj['Color'],\n        // Cents : obj['Cents'],\n        // Default : obj['Default'],\n        // Expanded : obj['Expanded'],\n        Categories : []\n      }\n      if(obj['Icon']) {\n        masterCategory['Icon'] = {\n          Filename : obj['Icon']['Filename']\n        }\n      }\n\n      for(var i = 0; i < obj['Categories'].length; i++)\n      {\n        masterCategory.Categories.push(parseSubCategory(obj['Categories'][i]));\n      }\n\n      return masterCategory;\n    }\n\n    function parseSubCategory(obj) {\n      var subCategory = {\n        Default : obj['Default'],\n        ID : obj['ID'],\n        Title : obj['Title'],\n      };\n      if(obj['Icon']) {\n        subCategory['Icon'] = {\n          Filename : obj['Icon']['Filename']\n        }\n      }\n\n      return subCategory;\n    }\n\n    function parseQuestion(obj)\n    {\n      var returnObj = {\n        Question : obj['Title'],\n        TemplateColor : obj['TemplateColor'],\n        Color : obj['Color'],\n        Buttons : []\n      }\n\n      // Some of the question have special button interaction\n      // @Toggle      Boolean   Will turn off the other buttons when set to active\n      if(obj['ButtonOptions']) {\n        returnObj['ButtonOptions'] = {\n          Toggle : obj['ButtonOptions']['Toggle'],\n          ToggleSelectDefault : obj['ButtonOptions']['ToggleSelectDefault']\n        }\n      } else {\n        returnObj['ButtonOptions'] = {\n          Toggle : false\n        }\n      }\n\n      for(var i = 0; i < obj['Buttons'].length; i++)\n      {\n        var button = obj['Buttons'][i];\n        returnObj.Buttons.push(\n          {\n            CategoryId : button.CategoryId,\n            Title : button.Title,\n            Icon : button.Icon,\n            Categories : button.Categories\n          }\n        );\n      }\n\n      return returnObj;\n    }\n\n    /*\n    * Find the Default items within all the Sub Categories\n    *\n    * @param availableMasterCategories:      Array:  An array of formatted Master category objects\n\n      @return Array\n    * */\n    function getDefaultSubCategories(availableMasterCategories)\n    {\n      var defaultSubCategories = [];\n\n      for(var i = 0; i < availableMasterCategories.length; i++)\n      {\n        var availableMasterCategory = availableMasterCategories[i];\n        for(var j = 0; j < availableMasterCategory.Categories.length; j++) {\n          var availableCategory = availableMasterCategory.Categories[j];\n          if(availableCategory['Default']) {\n            defaultSubCategories.push(availableCategory['ID']);\n          }\n        }\n      }\n\n      return defaultSubCategories;\n    }\n\n    /*\n    * Use a passed list of sub category Ids to format them into Master Categories with many Sub categories\n    *\n    * @param categoriesArray:                Array:  An Array of integers\n    * @param availableMasterCategories:      Array:  An array of formatted Master category objects\n    * @param defaultPeriod: Optional         Object: The formatted Period Object\n\n      @return Object: Formatted budget template\n    * */\n    function associateCategoriesWithMasterCategories(categoriesArray, availableMasterCategories, defaultPeriod)\n    {\n      var tempSelectedCategories = categoriesArray;\n\n      var masterCategoriesObj = {};\n      // Create this users Master and Categories from the set category Ids\n      for(var i = 0; i < tempSelectedCategories.length; i++)\n      {\n        // console.log(tempSelectedCategories[i]);\n        for(var j = 0; j < availableMasterCategories.length; j++)\n        {\n          var availableMasterCategory = availableMasterCategories[j];\n          // console.log(availableMasterCategories[j].Title);\n          for(var k = 0; k < availableMasterCategory.Categories.length; k++)\n          {\n            var availableCategory = availableMasterCategory.Categories[k];\n            // console.log(availableCategory.Title);\n            if(availableCategory.ID == tempSelectedCategories[i]) {\n\n              if(masterCategoriesObj[availableMasterCategory.ID] == undefined) {\n                masterCategoriesObj[availableMasterCategory.ID] = {\n                  ID : availableMasterCategory.ID,\n                  Title : availableMasterCategory.Title,\n                  Icon : availableMasterCategory.Icon.Filename,\n                  Color : availableMasterCategory.Color,\n                  PieValuePercent : 0,\n                  ValueCents : 0,\n                  ValueFormattedString : '$0.00',\n                  DisplayOpen: false,\n                  SubCategories : []\n                }\n              }\n\n              var newSubCategory = {\n                ID: availableCategory.ID,\n                MasterCategoryID: availableMasterCategory.ID,\n                Title : availableCategory.Title,\n                Image: availableCategory.Icon.Filename,\n                ValueCents : 0,\n                ValueFormattedString : '0.00'\n              };\n\n              if(defaultPeriod != undefined) // Only set the period if defined\n              {\n                newSubCategory['Period'] = defaultPeriod;\n              }\n\n              masterCategoriesObj[availableMasterCategory.ID].SubCategories.push(newSubCategory);\n            }\n          }\n        }\n\n      }\n\n\n      // Convert the Object to an Array\n      var masterCategories = [];\n      angular.forEach(masterCategoriesObj, function(value, key)\n      {\n        masterCategories.push(value);\n      });\n\n      console.log(masterCategories);\n\n      return masterCategories;\n    }\n\n    var service = {\n      parseQuestion : parseQuestion,\n      parsePageData : parsePageData,\n\n      getDefaultSubCategories : getDefaultSubCategories,\n      associateCategoriesWithMasterCategories : associateCategoriesWithMasterCategories\n    };\n\n    return service;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .factory('BudgetCalculator', BudgetCalculator);\n\n  /** @ngInject */\n  function BudgetCalculator($log, $http, $location, colourGenerator) {\n\n    var factory = {\n      current : new Budget(colourGenerator)\n    }\n\n    return factory;\n  }\n})();\n\n'use strict';\n\nfunction Budget(colourGenerator)\n{\n  var scope = this;\n  scope.colourGenerator = colourGenerator;\n};\n\n/*@public\n* The instance of this budget\n* */\nBudget.prototype.instance;\n\nBudget.prototype.changeSinceSave = true;\n\n/*@public\n* Create  new budget\n\n  @return self populated instance\n* */\nBudget.prototype.create = function(title)\n{\n  title = (title != undefined) ? title : '';\n\n  this.instance = {\n    Income : {\n      Streams : [\n\n      ],\n      TotalCents : 0,\n      Title: title\n      // Period : ''\n    },\n  };\n\n  return this.instance;\n};\n\n/*@public\n* Update the period this budget is being worked out for\n\n  @return self populated instance\n* */\nBudget.prototype.updateBudgetPeriod = function(period)\n{\n  this.instance.Income.Period = period;\n\n  return this.instance;\n};\n\n/*@public\n* Add a users income stream to the budget\n*\n* @param title:       String:  A name or title for this income\n* @param cents:       Integer: The cents value of this income\n* @param period:      Object:  Formatted Perioud object {shortname, title, per year}\n* @param removeable:  Boolean: Can the user remove this from their overall income\n\n  @return nothing\n* */\nBudget.prototype.addIncomeStream = function(title, cents, period, removeable)\n{\n  var formatCents = this.centsToValueFormattedString(cents);\n  this.instance.Income.Streams.push({Title:title, Cents:cents, CentsFormattedString:formatCents, Period: period, Removable:removeable});\n\n  var totalCents = 0;\n  for(var i = 0; i < this.instance.Income.Streams.length; i++)\n  {\n    var cents = parseInt(this.instance.Income.Streams[i].Cents);\n    totalCents += cents;\n  }\n\n  // Update the amount of cents value\n  this.instance.Income.TotalCents = parseInt(totalCents);\n  this.instance.Income.TotalFormattedString = this.centsToValueFormattedString(totalCents);\n  this.instance.Income.Period = period;\n};\n\n/*@public\n* Delete an income stream\n\n  @return updated Income stream Array\n* */\nBudget.prototype.deleteIncomeStream = function(index)\n{\n  this.instance.Income.Streams.splice(index, 1);\n  return this.instance.Income.Streams;\n};\n\nBudget.prototype.strDollarsToCents = function (str) {\n\n  //remove commas and convert to cents\n  var cents = parseFloat(str.replace(/,/g, '')) * 100;\n  return cents;\n\n};\n\nBudget.prototype.guid = function guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n    s4() + '-' + s4() + s4() + s4();\n}\n\n\n\nBudget.prototype.centsToValueFormattedString = function (valueInCents, round) {\n\n  var t = parseFloat(Math.round((valueInCents/100) * 100) / 100).toFixed(2)\n\n  if(round) {\n    t = parseInt(Math.round(t));\n  }\n\n  //remove commas and convert to cents\n  var valueFormattedString = t.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\");\n  return valueFormattedString;\n\n};\n\n\n\n/*@public\n* Bulk add many Master and sub categories\n*\n* @param categories:  Array:  Formatted array\n\n  @return nothing\n* */\nBudget.prototype.addInitialCategories = function(categories)\n{\n  this.instance.MasterCategories = categories;\n};\n\n/*@public\n* Add a new Master Category to the Master Categories Array\n*\n* @param masterCategoryTitle:  String:  The title of the new Master Category\n\n  @return the updated master categories\n* */\nBudget.prototype.addNewMasterCategory = function(masterCategoryTitle)\n{\n\n  var newMasterCategory = {\n    ID: this.guid(),\n    Title : masterCategoryTitle,\n    // Icon : '/themes/sorted/standalone/tools/budget-calculator/assets/images/everyday_expenses.svg',\n    Icon : '',\n    Color: this.colourGenerator.getNextColour(),\n    ValueCents : 0,\n    ValueFormattedString : '$0',\n    PieValuePercent : 0,\n    DisplayOpen: false,\n    SubCategories : []\n  }\n\n  this.instance.MasterCategories.push(newMasterCategory);\n\n  return this.instance.MasterCategories;\n};\n\n/*@public\n* Get all Master Categories data\n\n  @return MasterCategories Array\n* */\nBudget.prototype.getCategories = function()\n{\n  return this.instance.MasterCategories;\n};\n\n/*@public\n* Delete a specific sub category from a Master category\n\n  @return updated MasterCategories Array\n* */\nBudget.prototype.deleteSubCategoryByIndex = function(masterCategoryIndex, subCategoryIndex)\n{\n  this.instance.MasterCategories[masterCategoryIndex]['SubCategories'].splice(subCategoryIndex, 1);\n\n  this.calculateValues();\n\n  return this.instance.MasterCategories;\n};\n\n/*@public\n* Add a new sub category to the chosen master category\n*\n* @param masterCategoryIndex:  Integer:  The index of the master category\n* @param masterCategoryId:     Integer:  The id of the master category\n* @param title:                String:   The new sub category title\n\n  @return the updated master's sub categories\n* */\nBudget.prototype.addNewSubCategoryToMasterCategory = function(\n  masterCategoryIndex,\n  masterCategoryId,\n  title,\n  valueInCents,\n  period,\n  imagePath\n)\n{\n  var tempObj = angular.copy(this.instance);\n\n  if(period === undefined) {\n    period = tempObj['Income']['Period'];\n  }\n\n  if(valueInCents === undefined) {\n    valueInCents = 0;\n  }\n\n  debugger;\n  var valueFormattedString = this.centsToValueFormattedString(valueInCents);\n\n  var subCategory = {\n      ID: this.guid(),\n      MasterCategoryID: masterCategoryId,\n      Title : title,\n      Image: imagePath,\n      ValueCents : valueInCents,\n      ValueFormattedString : valueFormattedString,\n      Period : period\n    };\n\n  this.instance.MasterCategories[masterCategoryIndex].SubCategories.push(subCategory);\n\n\n  this.calculateValues();\n\n  return this.instance.MasterCategories[masterCategoryIndex].SubCategories;\n};\n\n\nBudget.prototype.updateSubCategoryByIndex = function(\n  masterCategoryIndex,\n  subCategoryIndex,\n  title,\n  valueInCents,\n  period,\n  imagePath\n)\n{\n\n  debugger\n\n  if(period === undefined) {\n    period = tempObj['Income']['Period'];\n  }\n\n  if(valueInCents === undefined) {\n    valueInCents = 0;\n  }\n\n  var valueFormattedString = this.centsToValueFormattedString(valueInCents);\n\n\n  var cat = this.instance.MasterCategories[masterCategoryIndex]['SubCategories'][subCategoryIndex];\n  cat.Title = title;\n  cat.ValueCents = valueInCents;\n  cat.Period = period;\n  cat.ValueFormattedString =  valueFormattedString;\n  cat.Image = imagePath;\n\n  this.calculateValues();\n\n  return this.instance.MasterCategories;\n};\n\n\n\n/*@public\n* Update the preferred view type for the user in this budget\n*\n* @param view:        String:  either 'grid' or 'list' view currently available\n*\n  @return Nothing\n* */\nBudget.prototype.setBudgetView = function(view)\n{\n  this.instance.PreferredView = view;\n};\n\n/*@public\n* Get the current view layout\n*\n  @return String\n* */\nBudget.prototype.getBudgetView = function()\n{\n  return this.instance.PreferredView\n};\n\n/*@public\n* Parse the Budget object to in an expected format to\n * deliver for the upload\n\n  @return Object\n* */\nBudget.prototype.parseForUpload = function()\n{\n  // Create a clone of the current budget instance\n  var cloneObj = JSON.parse(JSON.stringify(this.instance));\n\n  // Do some parse loop here\n\n  // Return the parsed object\n  return cloneObj;\n};\n\n\nBudget.prototype.deleteMasterCategotyByID = function (masterCategoryID) {\n\n  var foundAt;\n  for(var i = 0; i < this.instance.MasterCategories.length; i++)\n  {\n    if(this.instance.MasterCategories[i].ID === masterCategoryID) {\n      foundAt = i;\n    }\n  }\n  if (foundAt !== undefined) {\n    this.instance.MasterCategories.splice(foundAt, 1);\n  }\n\n  this.calculateValues();\n\n  return this.instance.MasterCategories;\n\n};\n\nBudget.prototype.updateMasterCategoryTitle = function (masterCategoryID, title) {\n\n  var masterCat = this.getMasterCategoryById(masterCategoryID);\n\n  if(masterCat) {\n    masterCat.Title = title;\n  }\n\n  return this.instance.MasterCategories;\n\n};\n\n/**\n * Finds the master categot by id and returns it\n *\n *\n * @param masterCategoryID\n * @returns Object\n */\nBudget.prototype.getMasterCategoryById = function (masterCategoryID) {\n\n  var masterCategory;\n\n  for(var i = 0; i < this.instance.MasterCategories.length; i++)\n  {\n    if(this.instance.MasterCategories[i].ID === masterCategoryID) {\n      masterCategory = this.instance.MasterCategories[i];\n    }\n  }\n\n  return masterCategory;\n\n}\n\n\n/*\n* @Public\n*\n* Do the actual calculation\n* Create a temporary Object and then update all the values within it.\n* Then Update all the values in teh live model\n*\n* @return The budget Object\n*\n* */\nBudget.prototype.calculateValues = function()\n{\n  var tempObj = angular.copy(this.instance);\n  console.log(tempObj);\n\n  var Income = tempObj['Income'];\n  var IncomeStreams = Income['Streams'];\n  var IncomeTotalCents = Income['TotalCents'];\n  var IncomePeriod = Income['Period']['PerYear'];\n\n  // console.log('IncomeTotalCents = ' + IncomeTotalCents);\n  // console.log('Income = ' + Income);\n  // console.log(Income);\n\n  var cents;\n  var incomeStreams_TotalCents = 0;\n  var incomeStreamsTotal_FormattedString;\n\n  for(var i = 0; i < IncomeStreams.length; i++)\n  {\n    var stream = IncomeStreams[i];\n    cents = stream['Cents'];\n    // console.log(cents);\n    incomeStreams_TotalCents += cents;\n  }\n  incomeStreamsTotal_FormattedString = this.centsToValueFormattedString(incomeStreams_TotalCents);\n  //incomeStreamsTotal_FormattedString = parseFloat(incomeStreams_TotalCents/100).toFixed(2).toString();\n\n\n  var masterCategories_TotalCents = 0;\n  var masterCategories_FormattedString;\n  var masterCategories = tempObj['MasterCategories'];\n  for(var i = 0; i < masterCategories.length; i++)\n  {\n    var masterCategory = masterCategories[i];\n    // var masterCategoryTotalCents = masterCategory['ValueCents'];\n    var masterCategoryTotalCents = 0;\n    // console.log(masterCategory);\n    for(var j = 0; j < masterCategory['SubCategories'].length; j++)\n    {\n      var subCategory = masterCategory['SubCategories'][j];\n      cents = subCategory['ValueCents'];\n      var period = subCategory['Period']['PerYear'];\n\n      var totalCents = cents * period;\n      var amountCents = totalCents / IncomePeriod;\n      masterCategoryTotalCents += amountCents;\n      // console.log(totalCents);\n    }\n    // masterCategory['ValueCents'] = masterCategoryTotalCents;\n    // tempObj['MasterCategories'][i]['SubCategories'][j]\n    // console.log(masterCategoryTotalCents);\n    tempObj['MasterCategories'][i]['ValueCents'] = masterCategoryTotalCents;\n    tempObj['MasterCategories'][i]['ValueFormattedString'] = '$' + this.centsToValueFormattedString(masterCategoryTotalCents, true);\n\n    masterCategories_TotalCents += masterCategoryTotalCents;\n  }\n\n  masterCategories_FormattedString = parseFloat(masterCategories_TotalCents/100).toFixed(2).toString();\n\n  // We know the total cents, let's find their percentage value\n  for(var i = 0; i < tempObj['MasterCategories'].length; i++)\n  {\n    var thisCents = parseInt(tempObj['MasterCategories'][i]['ValueCents']);\n    var dividedByTotal = parseFloat((thisCents / masterCategories_TotalCents) * 100).toFixed(0);\n    tempObj['MasterCategories'][i]['PieValuePercent'] = dividedByTotal;\n  }\n\n  // Update the values in this model\n\n  // Update the values for the Budget Total\n  this.instance.Income.TotalCents = incomeStreams_TotalCents;\n  this.instance.Income.TotalFormattedString = incomeStreamsTotal_FormattedString;\n\n  this.instance.MasterCategoriesTotalCents = masterCategories_TotalCents;\n  this.instance.MasterCategoriesTotalFormattedString = masterCategories_FormattedString;\n\n  this.instance.Income.LeftToBudget = parseFloat((incomeStreams_TotalCents - masterCategories_TotalCents)/100).toFixed(2).toString();\n\n  // Update the values in the Master Categories\n  for(var i = 0; i < tempObj['MasterCategories'].length; i++)\n  {\n    this.instance.MasterCategories[i].ValueCents = tempObj['MasterCategories'][i]['ValueCents'];\n    this.instance.MasterCategories[i].ValueFormattedString = tempObj['MasterCategories'][i]['ValueFormattedString'];\n    this.instance.MasterCategories[i].PieValuePercent = (isNaN(tempObj['MasterCategories'][i]['PieValuePercent'])) ? 0 : tempObj['MasterCategories'][i]['PieValuePercent'];\n  }\n\n  this.instance.changeSinceSave = true;\n\n  return this.instance;\n};\n\n//********* STATIC METHODS *********//\nBudget.math = {\n\n  convert : function (value, oldPeriod, newPeriod) {\n    if (value.eq(0)) {\n      return value;\n    }\n    return value.div(oldPeriod.PerYear).times(newPeriod.PerYear);\n  },\n\n  // If period is provided, display using its PerYear factor (otherwise, use Budget's)\n  displayDollars : function (value, period) {\n    if (typeof value === 'undefined') {\n      return value;\n    }\n    if (value.eq(0)) {\n      return value.toNumber();\n    }\n\n    var perYear = period ? period.PerYear : Budget.budget.Period.PerYear;\n    return value\n      .div(100)\n      .div(perYear)\n      .round(2)\n      .toNumber();\n  },\n\n  // For main display inline editable amounts, don't divide by period\n  displayCategoryDollars : function (value) {\n    if (typeof value === 'undefined') {\n      return value;\n    }\n    if (value.eq(0)) {\n      return value.toNumber();\n    }\n    return value\n      .div(100)\n      .round(2)\n      .toNumber();\n  }\n};\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('toolHeader', toolHeader);\n\n  /** @ngInject */\n  function toolHeader(siteConfig) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/toolHeader/toolHeader.html',\n      scope: {\n        data:'=',\n        profiledata : '=',\n        budgetdata : '=',\n        breadcrumbs: '=',\n        imagepath: '='\n      },\n      controller: ToolheaderController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function ToolheaderController($uibModal,\n                                  BudgetCalculator,\n                                  profileApi,\n                                  $scope,\n                                  $rootScope,\n                                  Api) {\n      var vm = this;\n\n      vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n      vm.Api = Api;\n      vm.profileApi = profileApi;\n      vm.imagepath;\n\n      $rootScope.$watch('userLogged', function () {\n        if ($rootScope.userLogged) {\n          // see if the user is logged in\n          profileApi.isLoggedIn().then(function(response)\n          {\n\n            // se the users profile image\n            if(profileApi.getProfile()) {\n              // set the image of the logged in user //TODO: this needs to handle users with no images\n              console.log('set user image', profileApi.getProfile().Image.Filename);\n              if(profileApi.getProfile().Image.ID != 0 ) {\n\n                vm.imagepath = './' + profileApi.getProfile().Image.Filename;\n\n\n              }\n\n\n            }\n        })\n\n        }\n      });\n\n      $scope.$watch('imagepath', function(newValue) {\n        if (!newValue) return;\n        vm.imagepath = newValue;\n      });\n\n\n      vm.onSave_clickHandler = function(ev)\n      {\n        ev.preventDefault();\n        var parseObj = BudgetCalculator.current.parseForUpload();\n\n        Api.saveBudget(parseObj);\n\n      }\n\n\n      vm.isLoggedIn = function () {\n         if (vm.profileApi.getProfile()) {\n           return true;\n         }else {\n           return false;\n         }\n     }\n\n    }\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('TimeoutModalController', TimeoutModalController);\n\n  /** @ngInject */\n  function TimeoutModalController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $uibModalInstance,\n                                    categoryData,\n                                    BudgetCalculator) {\n    var vm = this;\n\n    vm.categoryData = categoryData.categoryData;\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      if(ev) {\n        ev.preventDefault();\n      }\n      $uibModalInstance.close();\n    };\n\n\n    activate();\n\n    function activate() {\n      console.log('TimeoutModalController : activate');\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('MultiBudgetModalController', MultiBudgetModalController);\n\n  /** @ngInject */\n  function MultiBudgetModalController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $uibModalInstance,\n                                    BudgetCalculator) {\n    var vm = this;\n    vm.Api = Api;\n\n    vm.editDate = vm.Api.getLastEditDate();\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      if(ev) {\n        ev.preventDefault();\n      }\n      $uibModalInstance.close();\n    };\n\n    vm.onOverWrite_clickHandler = function (ev) {\n\n      if(ev) {\n        ev.preventDefault();\n      }\n\n      var parseObj = BudgetCalculator.current.parseForUpload();\n      Api.saveBudget(parseObj, true);\n\n      $uibModalInstance.close();\n    }\n\n\n    activate();\n\n    function activate() {\n      console.log('MultiBudgetModalController : activate');\n\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('modalActivator', modalActivator);\n\n  /** @ngInject */\n  function modalActivator(ModalType,\n                          $uibModal,\n                          $rootScope) {\n    var directive = {\n      restrict: 'A',\n      scope: {\n        modalType: '@'\n      },\n      link: linkFunc,\n      controller: ModalactivatorController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    function linkFunc(scope, el, attr, vm) {\n\n      var onAddSubCategory_clickHandler = function(ev)\n      {\n        debugger\n        ev.preventDefault();\n\n        var masterData;\n        var subCatData;\n\n        var masterElData = el.attr('data-mastercategory');\n        var subCatElData = el.attr('data-subcategory');\n\n        if(angular.isDefined(masterElData)) {\n          masterData = {};\n          var masterCategoryData = JSON.parse(masterElData);\n          var masterCatId = parseInt(masterCategoryData['ID']);\n          var masterCategoryIndex = parseInt(el.attr('data-mastercatindex'));\n\n          masterData.masterCategoryID = masterCatId;\n          masterData.masterCategoryIndex = masterCategoryIndex;\n        }\n\n        if(angular.isDefined(subCatElData)) {\n          subCatData = {};\n          subCatData = JSON.parse(subCatElData);\n        }\n\n        var categoryIndex;\n        if(angular.isDefined(el.attr('data-catindex'))) {\n          categoryIndex = parseInt(el.attr('data-catindex'));\n        }\n\n        var masterCategoryIndex;\n        if(angular.isDefined(el.attr('data-mastercatindex'))) {\n          masterCategoryIndex = parseInt(el.attr('data-mastercatindex'));\n        }\n\n\n\n        var modalInstance = $uibModal.open({\n          templateUrl: 'app/components/modals/addEditSubCategoryModal.html',\n          controller: 'AddEditSubCategoryController',\n          controllerAs: '$ctrl',\n          size: 'lg',\n          resolve: {\n            mastercategoryData: function () {\n              return masterData;\n            },\n            subcategoryData: function () {\n              return subCatData;\n            },\n            masterCategoryIndex: function () {\n              return masterCategoryIndex;\n            },\n            categoryIndex: function () {\n              return categoryIndex;\n            }\n\n          }\n        });\n      }\n\n      var onDeleteSubCategory_clickHandler = function(ev)\n      {\n        ev.preventDefault();\n\n        debugger\n\n        var categoryData = JSON.parse(el.attr('data-subcategory'));\n        var subCatId = parseInt(categoryData['ID']);\n        var masterCatId = parseInt(categoryData['MasterCategoryID']);\n        var categoryTitle = categoryData['Title'];\n        var categoryIndex = parseInt(el.attr('data-catindex'));\n        var masterCategoryIndex = parseInt(el.attr('data-mastercatindex'));\n\n        var modalInstance = $uibModal.open({\n          templateUrl: 'app/components/modals/deleteSubCategoryModal.html',\n          controller: 'DeleteSubCategoryController',\n          controllerAs: '$ctrl',\n          size: 'md',\n          resolve: {\n            categoryData: function () {\n              return {\n                masterCategoryID : masterCatId,\n                subCategoryId : subCatId,\n                categoryTitle : categoryTitle,\n                categoryIndex : categoryIndex,\n                masterCategoryIndex : masterCategoryIndex\n              };\n            }\n          }\n        });\n      }\n\n      var onEditBudget_clickHandler = function(ev)\n      {\n        ev.preventDefault();\n\n        var modalInstance = $uibModal.open({\n          templateUrl: 'app/components/modals/editBudgetModal.html',\n          controller: 'EditBudgetModalController',\n          controllerAs: '$ctrl',\n          size: 'lg'\n\n        });\n\n        modalInstance.result.then(function(){\n          //console.log('close');\n         }, function(){\n          console.log('dismiss');\n          $rootScope.$broadcast('resetBudget');\n         });\n      }\n\n\n\n      var onEditMasterCat_clickHandler = function(ev)\n      {\n        ev.preventDefault();\n\n        var categoryData = JSON.parse(el.attr('data-mastercategory'));\n\n        var modalInstance = $uibModal.open({\n          templateUrl: 'app/components/modals/editMasterCatModal.html',\n          controller: 'EditMasterCatModalController',\n          controllerAs: '$ctrl',\n          size: 'md',\n          resolve: {\n            categoryData: function () {\n              return {\n                categoryData : categoryData,\n\n              };\n            }\n          }\n\n        });\n      }\n\n\n      var onDeleteMasterCat_clickHandler = function(ev)\n      {\n        ev.preventDefault();\n\n        debugger\n        var categoryData = JSON.parse(el.attr('data-mastercategory'));\n\n        var modalInstance = $uibModal.open({\n          templateUrl: 'app/components/modals/deleteMasterCategoryModal.html',\n          controller: 'DeleteMasterCategoryController',\n          controllerAs: '$ctrl',\n          size: 'md',\n          resolve: {\n            categoryData: function () {\n              return {\n                categoryData : categoryData,\n\n              };\n            }\n          }\n\n        });\n      }\n\n      function addListeners()\n      {\n        switch(scope.modalType)\n        {\n          case ModalType.EDIT_BUDGET :\n            el.addClass('pointer');\n            el.on('click', onEditBudget_clickHandler);\n            break;\n\n          case ModalType.DELETE_SUBCATEGORY :\n            el.addClass('pointer');\n            el.on('click', onDeleteSubCategory_clickHandler);\n            break;\n\n          case ModalType.ADD_SUBCATEGORY :\n            el.addClass('pointer');\n            el.on('click', onAddSubCategory_clickHandler);\n            break;\n\n          case ModalType.EDIT_MASTER_CATEGORY:\n            el.addClass('pointer');\n            el.on('click', onEditMasterCat_clickHandler);\n            break;\n\n          case ModalType.DELETE_MASTER_CATEGORY:\n            el.addClass('pointer');\n            el.on('click', onDeleteMasterCat_clickHandler);\n            break;\n        }\n      }\n\n      function activate()\n      {\n        addListeners();\n      }\n\n      activate();\n\n      scope.$on('$destroy', function () {\n\n      });\n    }\n\n\n\n    /** @ngInject */\n    function ModalactivatorController($scope) {\n      var vm = this;\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('EditMasterCatModalController', EditMasterCatModalController);\n\n  /** @ngInject */\n  function EditMasterCatModalController(profileApi,\n                                        siteConfig,\n                                        SiteData,\n                                        Api,\n                                        $scope,\n                                        $rootScope,\n                                        categoryData,\n                                        $uibModalInstance,\n                                        BudgetCalculator,\n                                        budgetingToolConfig) {\n\n    var vm = this;\n\n\n    vm.siteConfig = siteConfig;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n    // init the vars\n    vm.categoryData = categoryData.categoryData;\n    vm.categoryTitle = vm.categoryData.Title;\n    vm.iconSrc = vm.TOOL_ASSETS + vm.categoryData.Icon;\n    vm.catColor = vm.categoryData.Color;\n    vm.catId = vm.categoryData.ID;\n    vm.icon = vm.categoryData.Icon;\n\n    console.log(categoryData);\n\n    vm.onOk_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n      console.log('on click');\n      console.log(ev);\n\n      BudgetCalculator.current.updateMasterCategoryTitle( vm.categoryData.ID, vm.categoryTitle);\n\n      $uibModalInstance.close();\n    };\n\n    vm.onDelete_clickHandler = function (ev) {\n      ev.preventDefault();\n\n      BudgetCalculator.current.deleteMasterCategotyByID(vm.categoryData.ID);\n      \n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n\n    };\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      $uibModalInstance.close();\n    }\n\n    activate();\n\n    function activate() {\n      console.log('EditMasterCatModalController : activate');\n\n\n      console.log();\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('EditBudgetModalController', EditBudgetModalController);\n\n  /** @ngInject */\n  function EditBudgetModalController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $rootScope,\n                                     $uibModalInstance,\n                                     BudgetCalculator,\n                                     budgetingToolConfig) {\n\n    var vm = this;\n\n    vm.startCalc = angular.copy(BudgetCalculator.current.instance);\n    vm.budgetCalculator = BudgetCalculator.current.instance;\n    vm.budgetPeriods = budgetingToolConfig.BUDGET_PERIODS;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n    vm.isLoggedIn;\n    vm.userProfileData;\n\n    vm.onRemoveIncome_clickHandler = function(ev, streamModel, index)\n    {\n      BudgetCalculator.current.deleteIncomeStream(index);\n\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n    }\n\n    vm.onAddIncome_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      // vm.stateAddStream = !vm.stateAddStream;\n\n      var period = angular.copy(BudgetCalculator.current.instance.Income.Period);\n      console.log(period);\n\n      BudgetCalculator.current.addIncomeStream('', 0, period, true);\n    }\n\n    vm.onOk_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n      console.log('on click');\n      console.log(ev);\n\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n      $uibModalInstance.close();\n    }\n\n    vm.onUpdateStream_blurHandler = function(ev, streamModel)\n    {\n\n      var tempVal = angular.copy(streamModel.CentsFormattedString);\n      streamModel.Cents = BudgetCalculator.current.strDollarsToCents(tempVal);\n\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n    }\n\n    vm.onSetBudgetPeriod_clickHandler = function(ev, period)\n    {\n      // subCategoryModel.Period = angular.copy(period);\n      period = angular.copy(period);\n      BudgetCalculator.current.updateBudgetPeriod(period);\n\n\n    }\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      vm.budgetCalculator.Income.Title        = vm.startCalc.Income.Title;\n      vm.budgetCalculator.Income.Period.Title = vm.startCalc.Income.Period.Title;\n      vm.budgetCalculator.Income.Streams      = vm.startCalc.Income.Streams;\n\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n\n      $uibModalInstance.close();\n    }\n\n    $scope.$on('resetBudget', function(event, args) {      \n      vm.budgetCalculator.Income.Title        = vm.startCalc.Income.Title;\n      vm.budgetCalculator.Income.Period.Title = vm.startCalc.Income.Period.Title;\n      vm.budgetCalculator.Income.Streams      = vm.startCalc.Income.Streams;\n\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n\n    });\n\n    activate();\n\n    function activate() {\n      console.log('EditBudgetModalController : activate');\n\n      vm.isLoggedIn = false;\n\n      vm.userProfileData = {\n        Profile : {\n          // ImageSource : './' + profileApi.profile.Image.FileName\n          ImageSource : vm.TOOL_ASSETS + 'assets/images/user-icon.svg'\n        }\n      }\n\n\n      console.log(profileApi.getProfile());\n      console.log('11111111111111111111111111111111111111111');\n\n      if(profileApi.getProfile()) {\n        vm.isLoggedIn = true;\n\n        if(profileApi.getProfile().Image.ID != 0 ) {\n          vm.userProfileData = {\n            Profile : {\n              ImageSource : './' + profileApi.getProfile().Image.Filename\n            }\n          }\n        }\n      }\n\n\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('DeleteSubCategoryController', DeleteSubCategoryController);\n\n  /** @ngInject */\n  function DeleteSubCategoryController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $rootScope,\n                                    $uibModalInstance,\n                                    $uibModalStack,\n                                    categoryData,\n                                    BudgetCalculator) {\n\n    var vm = this;\n\n    vm.subCategoryTitle = categoryData.categoryTitle;\n\n    vm.onDelete_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n      \n      \n\n      var masterCategoryIndex = categoryData.masterCategoryIndex;\n      var categoryIndex = categoryData.categoryIndex;\n\n      BudgetCalculator.current.deleteSubCategoryByIndex(masterCategoryIndex,categoryIndex);\n\n      $rootScope.$broadcast('chartRefresh');\n      $uibModalStack.dismissAll('close');\n    }\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      $uibModalInstance.close();\n    }\n\n    activate();\n\n    function activate() {\n      console.log('DeleteSubCategoryController : activate');\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('DeleteMasterCategoryController', DeleteMasterCategoryController);\n\n  /** @ngInject */\n  function DeleteMasterCategoryController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $rootScope,\n                                    $uibModalInstance,\n                                    $uibModalStack,\n                                    categoryData,\n                                    BudgetCalculator) {\n\n    var vm = this;\n\n    vm.categoryData = categoryData.categoryData;\n\n    vm.onDelete_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n      \n      BudgetCalculator.current.deleteMasterCategotyByID(vm.categoryData.ID);\n      BudgetCalculator.current.calculateValues();\n      $rootScope.$broadcast('chartRefresh');\n      $uibModalStack.dismissAll('close');\n      $uibModalInstance.close();\n    };\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      $uibModalInstance.close();\n    };\n\n\n    activate();\n\n    function activate() {\n      console.log('DeleteMasterCategoryController : activate');\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('AddEditSubCategoryController', AddEditSubCategoryController);\n\n  /** @ngInject */\n  function AddEditSubCategoryController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $timeout,\n                                    $scope,\n                                    $rootScope,\n                                    $uibModalInstance,\n                                    Upload,\n                                    budgetingToolConfig,\n                                    mastercategoryData,\n                                    BudgetCalculator,\n                                    subcategoryData,\n                                    masterCategoryIndex,\n                                    categoryIndex) {\n\n    var vm = this;\n\n    vm.title = 'Add Category';\n\n    vm.profileApi = profileApi;\n\n    vm.mastercategoryData = mastercategoryData;\n    vm.categoryIndex = categoryIndex;\n    vm.masterCategoryIndex = masterCategoryIndex;\n\n    vm.initialPeriod = budgetingToolConfig.BUDGET_PERIODS[budgetingToolConfig.DEFAULT_BUDGET_PERIOD];\n    vm.budgetPeriods = budgetingToolConfig.BUDGET_PERIODS;\n    vm.budget = '0.0';\n\n    vm.uploadProgress = 0;\n    vm.isUploading = false;\n\n    vm.period = angular.copy(vm.initialPeriod);\n\n    vm.isEdit = false;\n    vm.newCategory = {\n      Title : ''\n    };\n\n    vm.isLoggedIn = false;\n\n    profileApi.isLoggedIn().then(function (resp) {\n      vm.isLoggedIn = resp\n    });\n\n\n    // if sub category data is passed we are an edit not create\n    if(subcategoryData) {\n\n      console.log(subcategoryData);\n      vm.title = 'Edit Category';\n      vm.initialPeriod = subcategoryData.Period;\n      vm.budget = subcategoryData.ValueFormattedString;\n      vm.newCategory.Title = subcategoryData.Title;\n      vm.newCategory.File = subcategoryData.Image;\n      vm.subcategoryData = subcategoryData;\n      vm.isEdit = true;\n    }\n\n    // Category image upload\n    var _fileToUpload;\n\n    $scope.$watch('$ctrl.files', function () {\n      $scope.upload(vm.files);\n    });\n    $scope.$watch('$ctrl.file', function () {\n      if ($scope.file != null) {\n        vm.files = [vm.file];\n      }\n    });\n\n    $scope.upload = function (file) {\n\n      var url = vm.profileApi.getUploadURL();\n      console.log(url);\n\n      if (file) {\n\n          if (!file.$error) {\n            Upload.upload({\n              url: url,\n              data: {\n                Image: file\n              }\n            }).then(function (resp) {\n\n\n              vm.isUploading = false;\n              vm.newCategory.File = '.' + resp.data.data.imageURL;\n\n              $timeout(function() {\n\n                vm.isUploading = false;\n                vm.newCategory.File = '.' + resp.data.data.imageURL;\n\n              });\n            }, null, function (evt) {\n              vm.isUploading = true;\n              var progressPercentage = parseInt(100.0 * evt.loaded / evt.total);\n              console.log('P');\n              console.log(progressPercentage);\n              console.log(evt);\n              vm.uploadProgress = progressPercentage;\n              // $scope.log = 'progress: ' + progressPercentage +\n              //   '% ' + evt.config.data.file.name + '\\n' +\n              //   $scope.log;\n            });\n          }\n\n      }\n    };\n\n    vm.onSetPeriod_clickHandler = function(ev, period)\n    {\n      var tempPeriod = angular.copy(period);\n\n      vm.period = tempPeriod;\n    }\n\n    //\n    // $scope.upload = function (file) {\n    //\n    //   console.log('UPLOAD')\n    //   console.log(file);\n    //\n    //   if (file) {\n    //     if (!file.$error) {\n    //\n    //       _fileToUpload = file;\n    //\n    //       if(file.type.match('image')) {\n    //\n    //         console.log('file is image')\n    //\n    //         var reader = new FileReader();\n    //         reader.onload = function (e) {\n    //           $timeout(function()\n    //           {\n    //             vm.newCategory.File = e.target.result;\n    //           },1);\n    //\n    //         }\n    //         reader.readAsDataURL(file);\n    //\n    //         vm.profileApi.uploadBudgetImage(_fileToUpload).then(function (e) {\n    //           console.log('---------------------')\n    //           console.log(e);\n    //         })\n    //       }\n    //     }\n    //   }\n    // }\n\n    vm.createCategory = function()\n    {\n      var obj = angular.copy(vm.newCategory);\n\n      var numValid = 0;\n      var maxValid = 1;\n\n      if(obj.Title.length >= 0) {\n        numValid++;\n      }\n\n      if(numValid == maxValid) {\n        BudgetCalculator.current.addNewSubCategoryToMasterCategory(\n          mastercategoryData['masterCategoryIndex'],\n          mastercategoryData['masterCategoryID'], obj.Title,\n          BudgetCalculator.current.strDollarsToCents(vm.budget),\n          vm.period,\n          vm.newCategory.File\n        );\n\n        $rootScope.$broadcast('chartRefresh');\n\n\n        $uibModalInstance.close();\n      }\n    }\n\n\n    vm.updateCategory = function () {\n      $uibModalInstance.close();\n\n      var obj = angular.copy(vm.newCategory);\n\n\n      BudgetCalculator.current.updateSubCategoryByIndex(\n        masterCategoryIndex,\n        categoryIndex,\n        obj.Title,\n        BudgetCalculator.current.strDollarsToCents(vm.budget),\n        vm.period,\n        vm.newCategory.File\n      )\n      $rootScope.$broadcast('chartRefresh');\n\n    }\n\n    vm.onCategoryName_keyUpHandler = function(ev)\n    {\n      if (ev.defaultPrevented) {\n        return; // Should do nothing if the default action has been cancelled\n      }\n      var key;\n      var handled = false;\n      if (ev.key !== undefined) {\n        // Handle the event with KeyboardEvent.key and set handled true.\n        key = ev.which;\n      } else if (ev.keyIdentifier !== undefined) {\n        // Handle the event with KeyboardEvent.keyIdentifier and set handled true.\n        key = ev.keyIdentifier;\n      } else if (ev.keyCode !== undefined) {\n        // Handle the event with KeyboardEvent.keyCode and set handled true.\n        key = ev.keyCode;\n      }\n\n      if (handled) {\n        // Suppress \"double action\" if event handled\n        ev.preventDefault();\n      }\n\n\n      if(key == 13) { // On tapping Enter key\n\n        if(vm.isEdit) {\n          vm.updateCategory();\n        }else {\n          vm.createCategory();\n        }\n      }\n    }\n\n    vm.onOk_clickHandler = function(ev)\n    {\n\n      ev.preventDefault();\n\n      // if we are editing then save else create new\n      if(vm.isEdit) {\n        vm.updateCategory();\n      } else {\n\n        vm.createCategory();\n      }\n    }\n\n    vm.onCancel_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      $uibModalInstance.close();\n    }\n\n    activate();\n\n    function activate() {\n      console.log('AddSubCategoryController : activate');\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('introHeader', introHeader);\n\n  /** @ngInject */\n  function introHeader(siteConfig) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/intro-header/introHeader.html',\n      scope: {\n        data:'=',\n        breadcrumbs: '='\n      },\n      controller: IntroheaderController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    /** @ngInject */\n    function IntroheaderController(moment) {\n      var vm = this;\n\n      vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n    }\n  }\n\n})();\n\n// (function(){\n//   'use strict';\n//\n//   angular.module('sorted')\n//     .directive('breadcrumbs', ['$location', 'siteConfig', function ($location, siteConfig) {\n//       return {\n//         templateUrl: siteConfig.APP_PATH + 'app/components/breadcrumbs/breadcrumbs.html',\n//         restrict: 'E',\n//         controller: ['$scope', function ($scope) {\n//           var segments = $location.path()\n//             .replace(/^#?\\/?/g, '')\n//             .split('/');\n//           $scope.breadcrumbs = _.map(segments, function (path, index, crumbs) {\n//             var title = path.replace(/-/g, ' ');\n//             path = index > 0 ? '/' + path : path;\n//             path = crumbs.slice(0, index).join('/') + path;\n//             return {\n//               title: title,\n//               path: path\n//             };\n//           });\n//         }]\n//       };\n//     }]);\n//\n// })();\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('breadcrumbs', breadcrumbs);\n\n  /** @ngInject */\n  function breadcrumbs(budgetingToolConfig, siteConfig) {\n    var directive = {\n      restrict: 'E',\n      templateUrl: 'app/components/breadcrumbs/breadcrumbs.html',\n      scope: {\n        breadcrumbs: '='\n      },\n      link: linkFunc,\n      controller: BreadcrumbsController,\n      controllerAs: 'vm'\n    };\n\n    return directive;\n\n    function linkFunc(scope, el, attr, vm) {\n\n    }\n\n    /** @ngInject */\n    function BreadcrumbsController(moment) {\n      var vm = this;\n    }\n  }\n\n})();\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('WelcomeController', WelcomeController);\n\n  /** @ngInject */\n  function WelcomeController($timeout,\n                             $location,\n                             siteConfig,\n                             budgetingToolConfig,\n                             BudgetCalculator,\n                             SiteData,\n                             $log,\n                             $scope,\n                             Api,\n                             profileApi) {\n    var vm = this;\n\n    vm.siteConfig = siteConfig;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n    vm.Api = Api;\n    vm.profileApi = profileApi;\n\n    vm.breadcrumbs = [{\n      path : '/tool',\n      title : 'Tools'\n    },{\n      path : '/tool/budgeting-tool#/welcome',\n      title : 'Budgeting Tool'\n    },{\n      path : '/tool/budgeting-tool#/welcome',\n      title : 'Welcome'\n    }];\n\n    vm.data;\n    vm.isLoggedIn = false;\n\n    vm.budget = {\n      Cents : $location.search()['salary'],\n      Period : budgetingToolConfig.BUDGET_PERIODS[budgetingToolConfig.DEFAULT_BUDGET_PERIOD]\n    };\n    vm.initialPeriod = budgetingToolConfig.BUDGET_PERIODS[budgetingToolConfig.DEFAULT_BUDGET_PERIOD];\n\n    vm.budgetPeriods = budgetingToolConfig.BUDGET_PERIODS;\n\n    $scope.$on('$viewContentLoaded', function(){\n\n      SiteData.get('welcome').then(function(response)\n      {\n        vm.data = response;\n      });\n\n      profileApi.isLoggedIn().then(function(response)\n      {\n        vm.isLoggedIn = response;\n\n        //vm.Api.loadBudget();\n\n      }, function(error)\n      {\n        vm.isLoggedIn = false;\n      });\n\n    });\n\n    activate();\n\n\n\n\n    function activate() {\n      // console.log(Budget.static.simple());\n    }\n\n    vm.onSetPeriod_clickHandler = function(ev, period)\n    {\n      var tempPeriod = angular.copy(period);\n\n      vm.budget.Period = tempPeriod;\n    }\n\n    vm.next = function () {\n\n      vm.Api.setIsNewBudget(true);\n\n      if(!$scope.budgetAmountForm['amount-to-budget'].$valid) {\n        angular.element('#amount-to-budget').parent().addClass('input-invalid');\n      } else {\n        angular.element('#amount-to-budget').parent().removeClass('input-invalid');\n      }\n\n      if ($scope.budgetAmountForm.$valid) {\n\n        var cents = angular.copy(vm.budget.Cents);\n        cents = BudgetCalculator.current.strDollarsToCents(cents);\n\n        var period = angular.copy(vm.budget.Period);\n\n        BudgetCalculator.current.create('Your budget');\n        BudgetCalculator.current.addIncomeStream('My income', cents, period, false);\n\n        // var cents = angular.copy(\n        //     Budget.math.convert(vm.budget.Cents, vm.initialPeriod, vm.budget.Period)\n        //   );\n        // console.log(cents);\n\n        return $location.path('/budget-template');\n      }\n\n      // return;\n\n      // if ($scope.budgetAmountForm.$valid) {\n      //   var cents = angular.copy(\n      //     periodAmount.convert($scope.budget.Cents, $scope.initialPeriod, $scope.budget.Period)\n      //   );\n      //   $scope.budget.IncomeStreams = [{\n      //     Title: 'My income',\n      //     Cents: cents,\n      //     Removeable: false\n      //   }];\n      //   angular.copy($scope.budget, Budget.budget);\n      //\n\n      // }\n    };\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('ToolController', ToolController);\n\n  /** @ngInject */\n  function ToolController(profileApi,\n                                    BudgetCalculator,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $rootScope,\n                                    $window,\n                                    $location,\n                                    BudgetView,\n                                    $timeout,\n                                    $uibModal,\n                                    budgetingToolConfig) {\n\n    var vm = this;\n\n    vm.siteConfig = siteConfig;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n    vm.Api = Api;\n    vm.profileApi = profileApi;\n    vm.salary;\n\n    vm.breadcrumbs = [{\n      path : '/tool',\n      title : 'Tool'\n    },{\n      path : '/tool/budgeting-tool#/',\n      title : 'Budgeting Tool'\n    }];\n\n    vm.budgetPeriods = budgetingToolConfig.BUDGET_PERIODS;\n    vm.chartOptions = budgetingToolConfig.BREAKDOWN_CHART_OPTIONS;\n\n    vm.data;\n    vm.imagePath = vm.TOOL_ASSETS + 'assets/images/user-icon.svg';\n    vm.currentBudget;\n\n    vm.viewState;\n    vm.breakdownCollapse = false;\n    vm.isLoggedIn = false;\n    \n\n\n    vm.isReady = false;\n\n    vm.showMobileBudget = false;\n\n\n    $rootScope.$watch('userLogged', function () {\n      console.log('watch triggered');\n      if($rootScope.userLogged){\n        console.log('user now logged in');\n        $rootScope.userLogged = false;\n        var localNewBudget = false;\n\n        console.log('init budget test', BudgetCalculator.current.instance);\n        \n        if(BudgetCalculator.current.instance !== undefined){\n          if(vm.Api.getIsNewBudget()){\n           localNewBudget = true;\n          }\n        }else{\n          console.log('old budget maybe?');\n        }\n        \n        // see if the user is logged in\n        profileApi.isLoggedIn().then(function(response)\n        {\n          vm.isLoggedIn = response;\n\n          // try and load any existing budgets\n          vm.Api.loadBudget().then(function (resp) {\n            if(vm.Api.getBudgetData()) {\n              // if the budget hasnt been p\n              if(BudgetCalculator.current.instance) {\n                console.log('We already have a budget set');\n                \n                if(localNewBudget){\n                  vm.Api.setIsNewBudget(true);\n                  //trigger the overwrite modal\n                  var parseObj = BudgetCalculator.current.parseForUpload();\n                  vm.Api.saveBudget(parseObj);\n                }\n              } else {\n                console.log('Loading Budget');\n                BudgetCalculator.current.instance = vm.Api.getBudgetData();\n                $location.path(\"/\");\n              }\n            }else{\n              // Only auto save new budgets\n              vm.Api.setIsNewBudget(true);\n              console.log('now save');\n              var parseObj = BudgetCalculator.current.parseForUpload();\n              vm.Api.saveBudget(parseObj);\n            }\n          });          \n\n        });\n\n\n\n      }\n    });\n\n    $scope.$on('chartRefresh', function(event, args) {      \n      updateChartData();\n    });\n\n    $rootScope.$watch('chartRefresh', function(newValue) {\n      console.log('chart refresh', newValue);\n      if (!newValue) return;      \n      updateChartData();\n      vm.chartRefresh = false;\n      console.log('ran and set to', vm.chartRefresh);\n    });\n\n\n    vm.onToggleMobileBudget_clickHandler = function (ev) {\n\n      debugger\n\n      if(ev) {\n        ev.preventDefault()\n      }\n\n      vm.showMobileBudget = !vm.showMobileBudget;\n\n    }\n\n    vm.onSetPeriod_clickHandler = function(ev, period, subCategoryModel)\n    {\n      ev.preventDefault();\n      subCategoryModel.Period = angular.copy(period);\n\n      BudgetCalculator.current.calculateValues();\n      updateChartData();\n    }\n\n    // Popovers\n    vm.newMasterCategory = {\n      Title : '',\n      PopoverOpen : false,\n      SubCategories : undefined\n    }\n\n    vm.onMasterCategoryCancel_clickHandler = function(ev)\n    {\n      vm.newMasterCategory.PopoverOpen = false;\n      vm.newMasterCategory.Title = '';\n    }\n\n    vm.onMasterCategoryInput_keyUpHandler = function(ev)\n    {\n      if (ev.defaultPrevented) {\n        return; // Should do nothing if the default action has been cancelled\n      }\n      var key;\n      var handled = false;\n      if (ev.key !== undefined) {\n        // Handle the event with KeyboardEvent.key and set handled true.\n        key = ev.which;\n      } else if (ev.keyIdentifier !== undefined) {\n        // Handle the event with KeyboardEvent.keyIdentifier and set handled true.\n        key = ev.keyIdentifier;\n      } else if (ev.keyCode !== undefined) {\n        // Handle the event with KeyboardEvent.keyCode and set handled true.\n        key = ev.keyCode;\n      }\n\n      if (handled) {\n        // Suppress \"double action\" if event handled\n        ev.preventDefault();\n      }\n\n      // If hitting the Enter key, save the new Master Category\n      if (key == 13) {\n\n        var obj = angular.copy(vm.newMasterCategory);\n        BudgetCalculator.current.addNewMasterCategory(obj.Title);\n\n        vm.newMasterCategory.Title = '';\n        vm.newMasterCategory.PopoverOpen = false;\n      }\n    }\n\n    vm.onMaterCategoryEdit_clickHandler = function(ev) {\n      ev.preventDefault();\n      console.log('onMaterCategoryEdit_clickHandler');\n    }\n\n    vm.onMasterCategorySave_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      vm.newMasterCategory.PopoverOpen = false;\n\n      var obj = angular.copy(vm.newMasterCategory);\n      BudgetCalculator.current.addNewMasterCategory(obj.Title);\n\n      vm.newMasterCategory.Title = '';\n    }\n\n    vm.onViewToggle_clickHandler = function(ev, viewTo)\n    {\n      ev.preventDefault();\n\n      if(viewTo != vm.viewState)\n      {\n        vm.viewState = viewTo;\n        BudgetCalculator.current.setBudgetView(viewTo);\n      }\n    }\n\n    vm.onMasterCategory_clickHandler = function(ev, masterCategoryObj)\n    {\n      ev.preventDefault();\n\n      masterCategoryObj.DisplayOpen = !masterCategoryObj.DisplayOpen;\n    }\n\n    vm.onBreakdownToggle_clickHandler = function (ev) {\n      ev.preventDefault();\n\n      vm.breakdownCollapse = !vm.breakdownCollapse;\n    }\n\n    /*\n    * Sub Categories within a Master Category\n    * */\n    vm.onSubCategoryTitle_focusInHandler = function(ev, subCategoryObj)\n    {\n      ev.preventDefault();\n\n      subCategoryObj.stateEdit = true;\n    }\n\n    vm.onSubCategoryTitle_focusOutHandler = function(ev, subCategoryObj)\n    {\n      ev.preventDefault();\n\n      console.log(ev);\n\n      subCategoryObj.stateEdit = false;\n    }\n\n    vm.onSubCategoryValue_focusInHandler = function(ev, subCategoryObj)\n    {\n      ev.preventDefault();\n\n      subCategoryObj.stateEdit = true;\n\n      // console.log(subCategoryObj.ValueFormattedString);\n      // console.log(parseFloat(subCategoryObj.ValueFormattedString));\n\n      var tempVal = angular.copy(subCategoryObj.ValueFormattedString);\n      var convertToFloat = parseFloat(tempVal);\n      var isItNaN = isNaN(convertToFloat);\n\n      if((convertToFloat == 0) || isItNaN) {\n        subCategoryObj.ValueFormattedString = '';\n      }\n    }\n\n    vm.onSubCategoryValue_focusOutHandler = function(ev, subCategoryObj)\n    {\n      ev.preventDefault();\n\n      subCategoryObj.stateEdit = false;\n\n      var tempVal = angular.copy(subCategoryObj.ValueFormattedString);\n      var convertToFloat = parseFloat(tempVal);\n\n      // If the value string is empty then set to 0\n      if(isNaN(convertToFloat)) {\n        subCategoryObj.ValueFormattedString = '0.00';\n      }\n\n      tempVal = angular.copy(subCategoryObj.ValueFormattedString);\n      var cents = BudgetCalculator.current.strDollarsToCents(tempVal);\n      subCategoryObj.ValueCents = cents;\n\n      BudgetCalculator.current.calculateValues();\n      console.log('bam!');\n      updateChartData();\n    }\n\n    vm.onSubCategoryTitle_keyUpHandler = function(ev)\n    {\n\n      if(ev.keyCode == 13) // On Enter key\n      {\n        ev.preventDefault();\n\n        angular.element(ev.currentTarget).blur(); // Force focus out\n\n        return;\n      }\n    }\n\n    // Save this budget\n    vm.onSave_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n      var parseObj = BudgetCalculator.current.parseForUpload();\n\n      Api.saveBudget(parseObj);\n      Api.loadBudget();\n\n    }\n\n\n\n\n    function updateChartData()\n    {\n\n\n      var chartData = [];\n\n      var temp = angular.copy(BudgetCalculator.current.getCategories());\n\n      // Quickly check if this is the first time and set defaults\n      var isZeroed = true;\n      for(var i = 0; i < temp.length; i++)\n      {\n        if((temp[i].ValueCents > 0) && isZeroed) {\n          isZeroed = false;\n        }\n      }\n\n      if(!isZeroed) {\n        for(var i = 0; i < temp.length; i++)\n        {\n          chartData.push({\n            category : temp[i].Title,\n            dollars : temp[i].ValueCents / 100,\n            color : temp[i].Color\n          });\n        }\n      } else {\n        for(var i = 0; i < temp.length; i++)\n        {\n          var color = tinycolor(temp[i].Color);\n          color.setAlpha(0.5);\n          // color.lighten(35);\n\n          chartData.push({\n            category : temp[i].Title,\n            dollars : 0.25,\n            color : color.toRgbString()\n          });\n        }\n      }\n\n      vm.chartOptions.dataSource = new kendo.data.DataSource({\n        data: chartData\n      });\n    }\n\n    activate();\n\n    function activate() {\n\n    }\n\n    vm.showSaveWaring = function () {\n      console.log('check');\n\n      profileApi.isLoggedIn().then(function(response) {\n        vm.isLoggedIn = response;\n\n        if (!vm.isLoggedIn) {\n          debugger\n          var modalInstance = $uibModal.open({\n            templateUrl: 'app/components/modals/timeoutModal.html',\n            controller: 'EditBudgetModalController',\n            controllerAs: '$ctrl',\n            size: 'md'\n          });\n        }\n\n      });\n\n    }\n\n\n    $scope.onExit = function(e) {\n\n      if(BudgetCalculator.current.changeSinceSave) {\n        return 'You\\'re working on a budget that hasn\\'t been saved.'\n      }\n\n    };\n\n\n\n    $scope.$on('$viewContentLoaded', function(){\n\n      try {\n        document.getElementsByClassName('ToolBudgetCalculatorPage')[0].scrollIntoView();\n      } catch (e) {}\n\n\n      // see if the user is logged in\n      profileApi.isLoggedIn().then(function(response)\n      {\n        vm.isLoggedIn = response;\n\n        // se the users profile image\n        if(profileApi.getProfile()) {\n          // set the image of the logged in user //TODO: this needs to handle users with no images\n          console.log('set user image', profileApi.getProfile().Image.Filename);\n          if(profileApi.getProfile().Image.ID != 0 ) {\n            vm.imagePath = './' + profileApi.getProfile().Image.Filename;\n          }\n        }\n\n        // try and load any existing budgets\n        vm.Api.loadBudget().then(function (resp) {\n\n          if(vm.Api.getBudgetData()) {\n            // if the budget hasnt been p\n            if(BudgetCalculator.current.instance) {\n              console.log('We already have a budget set');\n            } else {\n              BudgetCalculator.current.instance = vm.Api.getBudgetData();\n            }\n            vm.startApp();\n          }\n\n          vm.startApp();\n\n        }, function (err) {\n\n          // if is no budget then we start the ap anyway\n          vm.startApp();\n        })\n\n\n\n      }, function(error)\n      {\n\n        vm.startApp();\n        vm.isLoggedIn = false;\n\n      });\n\n      // if we have a budget then we can just short cut and get into this\n      if( BudgetCalculator.current.instance) {\n        vm.startApp()\n      }\n\n\n\n    });\n\n\n    vm.startApp = function () {\n\n\n     // If there is no Budget instance yet, redirect to welcome\n     if(BudgetCalculator.current.instance == undefined) {\n       $location.path(\"/welcome\");\n       return;\n     }\n     \n      if(!Api.hasAccessedTool) {\n        if(profileApi.getProfile()) {\n          \n        } else {\n          $timeout(vm.showSaveWaring, 300000);\n        }\n        $window.onbeforeunload = $scope.onExit;\n      }\n\n      Api.hasAccessedTool = true;\n\n\n      SiteData.get('budgeting-tool').then(function(response)\n      {\n        // vm.data = setDataDefaults(response);\n        vm.data = response;\n\n      });\n\n      vm.currentBudget = BudgetCalculator.current.instance;\n      vm.budgetData = {\n        MasterCategories : BudgetCalculator.current.getCategories()\n      }\n      var preferredView = BudgetCalculator.current.getBudgetView();\n      vm.viewState = preferredView;\n\n      BudgetCalculator.current.calculateValues();\n\n\n      vm.isReady = true;\n\n      $timeout(updateChartData, 1);\n\n    }\n  }\n})();\n\n// (function () {\n//   'use strict';\n//\n//   angular.module('sorted.http')\n//     .factory('profileApi', [\n//       '$http',\n//       '$q',\n//       'siteConfig',\n//       function ($http, $q, siteConfig) {\n//         var BASE_URL = siteConfig.API_PREFIX + '/profile/';\n//\n//         function get () {\n//           return $http({\n//             method: 'GET',\n//             url: BASE_URL + 'get'\n//           })\n//             .then(function (response) {\n//               if (response.data.success === 'false') {\n//                 return $q.reject();\n//               }\n//               return response.data;\n//             }, function (error) {\n//               return $q.reject(error);\n//             });\n//         }\n//\n//         function isLoggedIn () {\n//           return get()\n//             .then(function () {\n//               return true;\n//             })\n//             .catch(function () {\n//               return false;\n//             });\n//         }\n//\n//         function uploadBudgetImage(image) {\n//           var method = 'POST';\n//           var url = BASE_URL + 'custom';\n//\n//           // NB: IE 10+ only\n//           // TODO: fallback option for the diehards still using IE 9\n//           var formData = new FormData();\n//           formData.append('Image', image);\n//           return $http({\n//             data: formData,\n//             method: method,\n//             url: url,\n//             transformRequest: angular.identity,\n//             headers: {'Content-Type': undefined}\n//           })\n//           .then(function (response) {\n//             return response.data;\n//           }, function () {\n//             return null;\n//           });\n//         }\n//\n//         return {\n//           get: get,\n//           uploadBudgetImage: uploadBudgetImage,\n//           isLoggedIn: isLoggedIn\n//         };\n//       }\n//     ]);\n//\n// })();\n\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .service('profileApi', profileApi);\n\n  /** @ngInject */\n  function profileApi($log,\n               $cookies,\n               $q,\n               $http,\n               $location,\n               siteConfig) {\n\n    // var DOMAIN = ($location.host() == 'localhost') ? 'http://sorted.local' : '' ;\n\n    var DOMAIN = setDomain();\n\n    var BASE_URL = DOMAIN + siteConfig.API_PREFIX + '/profile/';\n\n    var profile;\n\n\n    function getProfile() {\n      return profile\n    }\n\n    function setDomain()\n    {\n      var domain;\n      console.log($location.host());\n      switch($location.host()) {\n        case 'localhost' :\n          // domain = 'http://sorted.local/';\n          domain = 'http://localhost';\n          break;\n\n        // case '192.168.178.47' :\n        //   domain = 'http://192.168.33.10/';\n        //   break;\n\n        default :\n          domain = '';\n          break;\n      }\n\n      return domain;\n    }\n\n    function get () {\n\n\n      console.log(BASE_URL + 'get');\n\n      return $http({\n        method: 'GET',\n        url: BASE_URL + 'get'\n      })\n        .then(function (response) {\n          if (response.data.success === 'false') {\n            return $q.reject();\n          }\n          console.log(profile);\n          profile = response.data;\n          return response.data;\n        }, function (error) {\n          return $q.reject(error);\n        });\n    }\n\n    function isLoggedIn () {\n      return get()\n        .then(function () {\n          return true;\n        })\n        .catch(function () {\n          return false;\n        });\n    }\n\n    function getUploadURL() {\n      return BASE_URL + 'custom';\n    }\n\n    function uploadBudgetImage(image) {\n      var method = 'POST';\n      var url = BASE_URL + 'custom';\n\n      // NB: IE 10+ only\n      // TODO: fallback option for the diehards still using IE 9\n      var formData = new FormData();\n      formData.append('Image', image);\n      return $http({\n        data: formData,\n        method: method,\n        url: url,\n        transformRequest: angular.identity,\n        headers: {'Content-Type': undefined}\n      })\n        .then(function (response) {\n          return response.data;\n        }, function () {\n          return null;\n        });\n    }\n\n    return {\n      get: get,\n      uploadBudgetImage: uploadBudgetImage,\n      isLoggedIn: isLoggedIn,\n      getUploadURL: getUploadURL,\n      getProfile: getProfile,\n    };\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .service('Api', Api);\n\n  /** @ngInject */\n  function Api($log,\n               $cookies,\n               $q,\n               $http,\n               $uibModal,\n               $location,\n               BudgetCalculator,\n               toastr) {\n\n    var DOMAIN = setDomain();\n\n    var hasAccessedTool = false;\n\n    var budgetData;\n    var lastEditedDate;\n    var budgetId;\n    var isNewBudget = true;\n\n    function getLastEditDate () {\n      return lastEditedDate;\n    }\n\n    function getIsNewBudget () {\n      return isNewBudget;\n    }\n\n    function setIsNewBudget (isNew) {\n      isNewBudget = isNew;\n    }\n\n    function getBudgetData () {\n      return budgetData;\n    }\n\n    function setDomain()\n    {\n      var domain;\n      console.log($location.host());\n      switch($location.host()) {\n        case 'localhost' :\n          // domain = 'http://sorted.local/';\n          domain = 'http://localhost/';\n          break;\n\n        // case '192.168.178.47' :\n        //   domain = 'http://192.168.33.10/';\n        //   break;\n\n        default :\n          domain = '';\n          break;\n      }\n\n      return domain;\n    }\n\n\n    function loadBudget() {\n      console.log('Api : loadBudget');\n      var request = DOMAIN + 'api/v0.1/calculator/get/2';\n\n      return $http.get(request).then(function (resp) {\n        var budgetsArr = resp.data;\n\n        console.log(\"HAS DATA\", budgetsArr);\n        if(budgetsArr.length > 0){\n          try {\n\n            // try to convert the old format to an obj\n            budgetData = angular.copy(JSON.parse(budgetsArr[budgetsArr.length - 1].Data));\n          }catch (e) {\n            //we threw an error must be an object\n            budgetData = angular.copy(budgetsArr[budgetsArr.length - 1].Data);\n          }\n          lastEditedDate = new Date.parse(budgetsArr[budgetsArr.length - 1].LastEdited)\n          budgetId = budgetsArr[budgetsArr.length - 1].ID;\n          isNewBudget = false;\n          console.log(budgetsArr[budgetsArr.length - 1]);\n          console.log(budgetData);\n          console.log(lastEditedDate);\n        }\n\n        return budgetData;\n\n      });\n\n    }\n\n    function saveBudget(parsedObj, forceSave) {\n\n      if((getBudgetData() && getIsNewBudget())) {\n\n        if(forceSave) {\n          //console.log('Forced to save')\n        } else {\n\n          showWarning();\n          return\n        }\n\n      }\n      var request;\n      if(getIsNewBudget() && getBudgetData()) {\n\n        //console.log(\"is update\");\n        request = DOMAIN + 'api/v0.1/calculator/update/' + budgetId;\n\n      }else if (getIsNewBudget()) {\n\n        //console.log(\"is Save\");\n        request = DOMAIN + 'api/v0.1/calculator/save';\n\n\n      } else {\n\n        //console.log(\"is update\");\n        request = DOMAIN + 'api/v0.1/calculator/update/' + budgetId;\n\n      }\n\n\n      var cleanObj = angular.copy(parsedObj);\n\n      var sendData = {\n        Data: cleanObj,\n        CalcID: 2\n      };\n\n      BudgetCalculator.current.changeSinceSave = false;\n\n\n      $http.post(request,  sendData, {\n        headers: {'Content-Type': 'application/json'}\n      }).then(function (resp) {\n\n        toastr.success('Budget saved successfully');\n\n        isNewBudget = false;\n        var budgetsArr = resp.data;\n        if(budgetsArr.status == 'success'){\n          budgetId = budgetsArr.data;\n        }\n        return true;\n      }).catch(function (err) {\n        toastr.error('Please check your login and try again', 'Budget not saved!');\n        return false;\n      });\n    }\n\n    function showWarning () {\n\n      var modalInstance = $uibModal.open({\n        templateUrl: 'app/components/modals/multiBudgetModal.html',\n        controller: 'MultiBudgetModalController',\n        controllerAs: '$ctrl',\n        size: 'lg'\n      });\n\n    }\n\n    function get_SiteData()\n    {\n      var request = DOMAIN+'themes/sorted/json/budget-tool-v2/budget-tool-data.json';\n\n      return $http({\n        url: request,\n        headers: {'Content-Type': 'application/json'}});\n    }\n\n\n\n    var service = {\n      get_SiteData : get_SiteData,\n      getIsNewBudget: getIsNewBudget,\n      getLastEditDate: getLastEditDate,\n      setIsNewBudget: setIsNewBudget,\n      saveBudget : saveBudget,\n      loadBudget: loadBudget,\n      getBudgetData: getBudgetData,\n      hasAccessedTool: hasAccessedTool\n\n    };\n\n    return service;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('restrictCurrency', restrictCurrency);\n\n  /** @ngInject */\n  function restrictCurrency() {\n    var directive = {\n      restrict: 'A',\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope, el, attr) {\n\n      function on_keyPressHandler(ev)\n      {\n\n        if (ev.defaultPrevented) {\n          return; // Should do nothing if the default action has been cancelled\n        }\n        var key;\n        var handled = false;\n        if (ev.key !== undefined) {\n          // Handle the event with KeyboardEvent.key and set handled true.\n          key = ev.which;\n        } else if (ev.keyIdentifier !== undefined) {\n          // Handle the event with KeyboardEvent.keyIdentifier and set handled true.\n          key = ev.keyIdentifier;\n        } else if (ev.keyCode !== undefined) {\n          // Handle the event with KeyboardEvent.keyCode and set handled true.\n          key = ev.keyCode;\n        }\n\n        if (handled) {\n          // Suppress \"double action\" if event handled\n          ev.preventDefault();\n        }\n\n        // console.log(key);\n\n        if(key == 13) // On Enter key\n        {\n          ev.preventDefault();\n\n          angular.element(ev.currentTarget).blur();  // Force focus out\n\n          return;\n        }\n\n        if(key == 49 || key == 50 || key == 51 || key == 52 || key == 53 || key == 54 || key == 55 || key == 56 || key == 57 || key == 48 || key == 44 || key == 46 || key == 8 || key == 0) {\n\n          // Allow 1,2,3,4,5,6,7,8,9,0,.,, DELETE, DELETE\n\n        } else {\n          ev.preventDefault();\n          return;\n        }\n      }\n\n      function on_keyUpHandler(ev)\n      {\n        // Don't allow too many characters after the decimal\n        // var parseString = angular.element(ev.currentTarget).val();\n        // if(parseString.split('.')[1] && (parseString.split('.')[1].length > 2)) {\n        //   angular.element(ev.currentTarget).val(parseString.slice(0, -1));\n        // }\n      }\n\n      function on_blurHandler(ev)\n      {\n        var str = this.value;\n        // if(str.toString().length <= 0) {\n        //   str = '0';\n        // }\n        // console.log(str)\n\n        str = str.replace(/,/g, '');\n        var strToFloat = parseFloat(str).toFixed(2);\n\n        if(isNaN(strToFloat)) {\n          this.value = '0.00';\n        } else {\n          this.value = strToFloat.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\")\n          // this.value = strToFloat.toString();\n        }\n\n        var $input = $(this);\n        $input.trigger('input');\n        $input.trigger('change');\n      }\n\n\n      function on_focusHandler(ev)\n      {\n        var str = this.value;\n        if((parseFloat(str) <= 0) || isNaN(parseFloat(str))) {\n          this.value = '';\n        }\n      }\n\n      el.on('keypress', on_keyPressHandler);\n      el.on('keyup', on_keyUpHandler);\n      el.on('blur', on_blurHandler);\n      el.on('focus', on_focusHandler);\n\n      scope.$on('$destroy', function () {\n\n      });\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .directive('preventInputZoom', preventInputZoom);\n\n  /** @ngInject */\n  function preventInputZoom() {\n    var directive = {\n      link: linkFunc\n    };\n\n    return directive;\n\n    function linkFunc(scope, el, attr) {\n\n      function on_focusHandler(ev)\n      {\n        this.className += ' font-prevent-zoom';\n        this.classList.remove('font-prevent-zoom');\n      }\n\n      el.on('focus', on_focusHandler);\n\n      scope.$on('$destroy', function () {\n\n      });\n    }\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .factory('siteConfig', siteConfig);\n\n  /** @ngInject */\n  function siteConfig($log, $http, $location) {\n\n    var factory = {\n      APP_NAME: 'Sorted',\n      APP_VERSION: '0.1',\n      APP_PATH: '',\n      DATE_FORMAT: 'DD/MM/YYYY',\n      API_PREFIX: '/api/v0.1',\n      GTM_PAGEVIEW_VARIABLE: 'vPageUrl',\n      GTM_CUSTOM_EVENT_NAME: 'VirtualPageView',\n\n      TOOL_ASSETS : 'themes/sorted/standalone/tools/budget-calculator/'\n    }\n\n    return factory;\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .factory('colourGenerator', colourGenerator);\n\n    function colourGenerator (Colors) {\n      var _gradient = 0;\n      var _baseColour = 0;\n\n      // Returns a hex colour code faded to white by `fraction` percent\n      // (that is, 0.25 would be closer to white than 0.75).\n      function fadeColour(colour, fraction) {\n        if (fraction >= 1) {\n          return colour;\n        }\n        var components = colour.match(/[a-f\\d]{2}/gi);\n        return '#' +\n          _.map(components, function (n) {\n            var colourComponent = Math.floor(parseInt(n, 16) * fraction);\n            var whiteComponent = Math.floor(255 * (1 - fraction));\n            return (colourComponent + whiteComponent).toString(16);\n          })\n         .join('');\n      }\n\n      // RGBA from hex\n      function hexToRgba (colour, opacity) {\n        var components = colour.match(/[a-f\\d]{2}/gi);\n        return 'rgba(' + _.map(components, function (n) {\n            return parseInt(n, 16);\n          })\n          .join(',') + ',' + opacity + ')';\n      }\n\n      // Supply gradually fading variants of the defined app colours, then start\n      // re-using them only when they run out.\n      function getNextColour() {\n        if (_baseColour >= Colors.COLOUR_SET.length) {\n          _baseColour = 0;\n          _gradient++;\n        }\n        if (_gradient >= Colors.COLOUR_GRADIENTS.length) {\n          _gradient = 0;\n        }\n        return fadeColour(\n          Colors.COLOUR_SET[_baseColour++],\n          Colors.COLOUR_GRADIENTS[_gradient]\n        );\n      }\n\n      // Use at beginning if no amounts are budgeted yet\n      function getStartColour(colour) {\n        return fadeColour(colour, 0.5);\n      }\n\n      return {\n        getNextColour: getNextColour,\n        getStartColour: getStartColour,\n        hexToRgba: hexToRgba\n      };\n    }\n\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .factory('SiteData', SiteData);\n\n  /** @ngInject */\n  function SiteData($log,\n                    $http,\n                    $location,\n                    PagedataParser,\n                    $q,\n                    Api) {\n\n    var siteData;\n\n    /*\n    * Get all the site data from an API. A specific page data can be returned in the object\n\n      @param page:      String: The page key value from the API json\n\n      @return Returns a promise\n    * */\n    function get(page)\n    {\n      var deferred = $q.defer();\n\n      if(!siteData) {\n        console.log('Get data');\n        console.log('page = ' + page);\n\n        Api.get_SiteData().then(function(response)\n        {\n          console.log(response)\n          siteData = PagedataParser.fromDatabase(response.data);\n\n          if(page) {\n            deferred.resolve(siteData[page]);\n          } else {\n            deferred.resolve(siteData);\n          }\n\n        }, function(error)\n        {\n          // TODO: Something\n          console.log(error);\n\n          deferred.reject('Something bad happened');\n        });\n      } else {\n        if(page) {\n          deferred.resolve(siteData[page]);\n        } else {\n          deferred.resolve(siteData);\n        }\n      }\n\n      return deferred.promise;\n    }\n\n    var factory = {\n      get : get\n    }\n\n    return factory;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular.module('sortedBudgetingTool')\n    .constant('budgetingToolConfig', {\n      // Time (ms) after which save/replace alerts will fade\n      ALERT_TIMEOUT: 2500,\n\n      BREAKDOWN_CHART_OPTIONS: {\n        chartArea: {\n          height: 300,\n          width: 300,\n          margin: 0,\n          padding: 0\n        },\n        transitions: false,\n        legend: {\n          visible: false\n        },\n        series: [{\n          field: 'dollars',\n          overlay: {\n            gradient: 'none',\n          },\n         padding: 10\n        }],\n        seriesDefaults: {\n          type: 'donut',\n          startAngle: 90\n        },\n        legendItemClick: function(e) {\n          e.preventDefault();\n        },\n        legendItemHover: function(e) {\n          e.preventDefault();\n        },\n        tooltip: {\n          animation: {\n            duration: 0\n          },\n          template: '#= category #: #= kendo.format(\\'{0:C}\\',value > 0.25 ? value : 0)  #',\n          visible: true\n        }\n      },\n\n      // Transparent spacer series values, placed between budget values\n      BREAKDOWN_CHART_SPACER: 0.003,\n\n      BROWSER_CLOSE_WARNING: \"You're working on a budget that hasn't been saved.\",\n      BUDGET_PERIODS: [\n        { Shortname: 'weekly', Title: 'Weekly', PerYear: 52 },\n        { Shortname: 'fortnightly', Title: 'Fortnightly', PerYear: 26 },\n        { Shortname: 'fourweekly', Title: '4 Weekly', PerYear: 13 },\n        { Shortname: 'monthly', Title: 'Monthly', PerYear: 12 },\n        { Shortname: 'yearly', Title: 'Yearly', PerYear: 1 }\n      ],\n      BUDGETING_TOOL_PREFIX: 'app/pages',\n      BUDGETING_TOOL_PATH: '/tools/budgeting-tool',\n      BUDGETING_TOOL_IMAGE_PATH: 'assets/images/tools/budgeting-tool',\n\n      // Do NOT alter this! In the current calculator structure, Budgeting Tool\n      // uses this ID to look for user's budget. Other calculators also use the\n      // same table with different IDs.\n      CALC_ID: '2',\n\n      // Allowed image upload types\n      CATEGORY_IMAGE_TYPES: [\n        'image/gif',\n        'image/jpeg',\n        'image/png'\n      ],\n      CATEGORY_TITLE_PLACEHOLDER: 'Name your category',\n\n      // Opacity steps for use in generating master category icons\n      COLOUR_GRADIENTS: [\n        0.66, 0.33\n      ],\n\n      // Palette for use in breakdown chart and master category icons\n      COLOUR_SET: [\n        \"#ce0058\",\n        \"#704c99\",\n        \"#cadc3c\",\n        \"#00afff\",\n        \"#006e96\",\n        \"#ffd700\",\n        \"#20d4af\",\n        \"#e18cc8\"\n      ],\n      DEFAULT_BUDGET_TITLE: 'Your budget',\n\n      // What period should new budgets use by default? Indexes BUDGET_PERIODS\n      DEFAULT_BUDGET_PERIOD: 3,\n\n      // Any property on VIEW_TEMPLATES. Used where no saved value exists in a user budget.\n      DEFAULT_BUDGET_VIEW: 'list',\n\n      // IE doesn't support Number.MAX_SAFE_INTEGER. Lame.\n      // Unlikely we'll see budgets in excess of 9 trillion cents...\n      IE_MAX_SAFE_INTEGER: 9000000000000,\n\n      // Used in budget head modal\n      INCOME_STREAM_PLACEHOLDER: 'Income source',\n      LOGIN_REMINDER_TIMEOUT: 300000,\n\n      // How many characters to display in browser\n      MAX_CATEGORY_TITLE: 24,\n\n      // How many characters can be stored, period\n      MAX_CATEGORY_TITLE_FIELD: 50,\n\n      MAX_STREAMS: 5,\n      VIEW_TEMPLATES: {\n        grid: {\n          title: 'Grid View',\n          plateTitle: 'Visual with Images',\n          icon: 'grid.svg',\n          plateIcon:'gridPlate.svg',\n          url: 'gridView.html'\n        },\n        list: {\n          title: 'List View',\n          plateTitle: 'List View',\n          icon: 'list.svg',\n          plateIcon: 'listPlate.svg',\n          url: 'listView.html'\n        }\n      }\n    });\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .controller('BudgettemplateController', BudgettemplateController);\n\n  /** @ngInject */\n  function BudgettemplateController(profileApi,\n                                    siteConfig,\n                                    SiteData,\n                                    Api,\n                                    $scope,\n                                    $location,\n                                    BudgetTemplateParser,\n                                    BudgetCalculator,\n                                    BudgetView) {\n\n    var vm = this;\n\n    vm.siteConfig = siteConfig;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n\n    vm.breadcrumbs = [{\n      path : '/tool',\n      title : 'Tools'\n    },{\n      path : '/tool/budgeting-tool#/welcome',\n      title : 'Budgeting Tool'\n    },{\n      path : '/tool/budgeting-tool#/budget-template',\n      title : 'Budget Template'\n    }];\n\n    vm.data;\n    vm.TOOL_ASSETS = siteConfig.TOOL_ASSETS;\n\n    activate();\n\n    function activate() {\n\n    }\n\n    /*\n    * Skip click handler\n    * Use only default category Ids\n\n      @return nothing\n    * */\n    vm.onSkip_clickHandler = function(ev)\n    {\n      ev.preventDefault();\n\n      vm.submitForm(true);\n    }\n\n\n    /*\n    * Submit the options form\n    * Loop through the questions array and find which categories the user has selected\n    *\n    * finally, navigate to the Budgeting Tool\n\n      @return nothing\n    * */\n    vm.submitForm = function(useOnlyDefaults)\n    {\n      useOnlyDefaults = (useOnlyDefaults != undefined) ? useOnlyDefaults : false ;\n\n      var tempSelectedCategories = [];\n      var viewTypeIndex = 0;\n      var preferredView;\n\n      var availableMasterCategories = angular.copy(vm.data.MasterCategories);\n      var defaultCategories = BudgetTemplateParser.getDefaultSubCategories(availableMasterCategories);\n\n      var tempButtonsList = angular.copy(vm.data);\n\n      if(useOnlyDefaults) {\n\n        viewTypeIndex = 1;\n\n      } else {\n        // Iterate through the questions and find the options the user has selected\n        for(var i = 0; i < tempButtonsList.Questions.List.length; i++)\n        {\n          var question = tempButtonsList.Questions.List[i];\n          for(var j = 0; j < question.Buttons.length; j++)\n          {\n            var button = question.Buttons[j];\n            if(button.isSelected) {\n              // Add the categoryId's to the array\n              tempSelectedCategories = tempSelectedCategories.concat(button.Categories);\n            }\n\n            // Get the view type\n            if(i == tempButtonsList.Questions.List.length-1) {\n              if(button.isSelected) {\n                viewTypeIndex = j;\n              }\n            }\n          }\n        }\n      }\n\n      switch(parseInt(viewTypeIndex)) {\n        case 0 :\n          preferredView = BudgetView.GRID;\n          break;\n\n        case 1 :\n          preferredView = BudgetView.LIST;\n          break;\n      }\n\n      tempSelectedCategories = tempSelectedCategories.concat(defaultCategories);\n\n      // Remove any duplicate categories\n      var unique = tempSelectedCategories.filter(function(item, pos) {\n        return tempSelectedCategories.indexOf(item) == pos;\n      });\n\n      var period = BudgetCalculator.current.instance.Income.Period;\n\n      var masterCategories = BudgetTemplateParser.associateCategoriesWithMasterCategories(unique, availableMasterCategories, period);\n\n      // // Temp set some data\n      // var masterCategories = [\n      //   {\n      //     ID: 0,\n      //     Title : 'Everyday expenses',\n      //     Icon : '/themes/sorted/standalone/tools/budget-calculator/assets/images/everyday_expenses.svg',\n      //     ValueCents : 10000,\n      //     ValueFormattedString : '$100',\n      //     DisplayOpen: true,\n      //     SubCategories : [{\n      //       ID: 0,\n      //       MasterCategoryID: 0,\n      //       Title : 'Groceries',\n      //       Image: '/themes/sorted/standalone/tools/budget-calculator/assets/images/categories/groceries.jpg',\n      //       ValueCents : 0,\n      //       ValueFormattedString : '$0.00'\n      //     },\n      //       {\n      //         ID: 1,\n      //         MasterCategoryID: 0,\n      //         Title : 'Groceries',\n      //         Image: '/themes/sorted/standalone/tools/budget-calculator/assets/images/categories/groceries.jpg',\n      //         ValueCents : 0,\n      //         ValueFormattedString : '$0.00'\n      //       },\n      //       {\n      //         ID: 2,\n      //         MasterCategoryID: 0,\n      //         Title : 'Groceries',\n      //         Image: '/themes/sorted/standalone/tools/budget-calculator/assets/images/categories/groceries.jpg',\n      //         ValueCents : 0,\n      //         ValueFormattedString : '$0.00'\n      //       },\n      //       {\n      //         ID: 3,\n      //         MasterCategoryID: 0,\n      //         Title : 'Groceries',\n      //         Image: '/themes/sorted/standalone/tools/budget-calculator/assets/images/categories/groceries.jpg',\n      //         ValueCents : 0,\n      //         ValueFormattedString : '$0.00'\n      //       },\n      //       {\n      //         ID: 4,\n      //         MasterCategoryID: 0,\n      //         Title : 'Groceries',\n      //         Image: '/themes/sorted/standalone/tools/budget-calculator/assets/images/categories/groceries.jpg',\n      //         ValueCents : 0,\n      //         ValueFormattedString : '$0.00'\n      //       }]\n      //   }\n      // ];\n\n      BudgetCalculator.current.setBudgetView(preferredView);\n      BudgetCalculator.current.addInitialCategories(masterCategories);\n      BudgetCalculator.current.calculateValues();\n\n\n      return $location.path('/');\n    }\n\n    /*\n    * user has clicked a question Button item\n    * Different interactions depending on Button options\n    *\n    * @param preset:      Object:  This clicked button model\n    * @param index:       Int:     The index of where this preset is in the Question\n    * @param question:    Object:  The preset's parent Question model\n\n      @return nothing\n    * */\n    vm.onQuestion_clickHandler = function(ev, preset, index, question)\n    {\n      ev.preventDefault();\n\n      if(question.ButtonOptions) {\n        if(question.ButtonOptions.Toggle) {\n          for(var i = 0; i < question.Buttons.length; i++)\n          {\n            if(i == index) {\n              question.Buttons[i].isSelected = true;\n            } else {\n              question.Buttons[i].isSelected = false;\n            }\n          }\n        } else {\n          preset.isSelected = !preset.isSelected;\n        }\n      }\n    }\n\n    /*\n    * Set some data defaults\n    *\n\n      @return Object with defaults set\n    * */\n    function setDataDefaults(data)\n    {\n      for(var i = 0; i < data.Questions.List.length; i++)\n      {\n        var question = data.Questions.List[i];\n        if(question.ButtonOptions && question.ButtonOptions.Toggle) {\n          question['Buttons'][question.ButtonOptions.ToggleSelectDefault].isSelected = true; // Set list view to true\n        }\n      }\n\n      return data;\n    }\n\n    $scope.$on('$viewContentLoaded', function(){\n\n      try {\n        document.getElementsByClassName('ToolBudgetCalculatorPage')[0].scrollIntoView();\n      } catch (e) {}\n\n\n      // If there is no Budget instance yet, redirect to welcome\n      if(BudgetCalculator.current.instance == undefined) {\n\n        $location.path(\"/welcome\");\n\n        return;\n\n      }\n\n      SiteData.get('budget-template').then(function(response)\n      {\n        vm.data = setDataDefaults(response);\n      });\n\n      profileApi.isLoggedIn().then(function(response)\n      {\n        vm.isLoggedIn = response;\n      }, function(error)\n      {\n        vm.isLoggedIn = false;\n      });\n\n    });\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log) {\n\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .config(routeConfig);\n\n  function routeConfig($routeProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: 'app/tool/tool.html',\n        controller: 'ToolController',\n        controllerAs: 'tool'\n      })\n      .when('/welcome', {\n        templateUrl: 'app/welcome/welcome.html',\n        controller: 'WelcomeController',\n        controllerAs: 'welcome'\n      })\n      .when('/budget-template', {\n        templateUrl: 'app/budgettemplate/budgettemplate.html',\n        controller: 'BudgettemplateController',\n        controllerAs: 'btemplate'\n      })\n      .otherwise({\n        redirectTo: '/welcome'\n      });\n  }\n\n})();\n\n/* global malarkey:false, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .constant('malarkey', malarkey)\n    .constant('_', _)\n    .constant('BudgetView', {\n      LIST : 'list',\n      GRID : 'grid'\n    })\n    .constant('ModalType', {\n      EDIT_BUDGET : 'edit_budget',\n      DELETE_SUBCATEGORY : 'delete_subcategory',\n      ADD_SUBCATEGORY : 'add_subcategory',\n      EDIT_MASTER_CATEGORY: 'edit_master_category',\n      DELETE_MASTER_CATEGORY: 'delete_master_category',\n      LOGIN: 'login'\n    })\n    .constant('Colors', {\n      COLOUR_SET: [\n        \"#ce0058\",\n        \"#704c99\",\n        \"#cadc3c\",\n        \"#00afff\",\n        \"#006e96\",\n        \"#ffd700\",\n        \"#20d4af\",\n        \"#e18cc8\"\n      ],\n      COLOUR_GRADIENTS: [\n        0.66, 0.33\n      ]\n    })\n\n    .constant('moment', moment);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('sortedBudgetingTool')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig) {\n    // Enable log\n    //$logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 5000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = false;\n    toastrConfig.progressBar = true;\n  }\n\n})();\n\nangular.module(\"sortedBudgetingTool\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/budgettemplate/budgettemplate.html\",\"<intro-header data=btemplate.data.Header breadcrumbs=btemplate.breadcrumbs></intro-header><div class=container><div class=budgeting-questions><form name=budgetTemplateQuestions ng-submit=btemplate.submitForm()><div class=row><div class=budget-skip-link-top><a class=font-orange ng-click=btemplate.onSkip_clickHandler($event)>SKIP <i class=\\\"fa fa-chevron-right font-xs\\\"></i></a><br></div></div><div class=\\\"budget-template-question text-center\\\" ng-repeat=\\\"question in btemplate.data.Questions.List\\\"><div class=\\\"row text-center budget-question\\\"><h5>{{$index+1}}. {{question.Question}}</h5></div><div class=\\\"row preset-container text-center\\\"><div class=budget-preset ng-repeat=\\\"preset in question.Buttons\\\"><div class=\\\"preset-icon col-xs-6\\\" ng-style=\\\"preset.isSelected ? {\\'background-color\\':\\'{{question.TemplateColor}}\\'} : {\\'background-color\\':\\'transparent\\'}\\\"><!-- <button class=\\\"preset-button\\\" ng-click=\\\"btemplate.onQuestion_clickHandler($event, preset, $index, question)\\\" ng-class=\\\"{active:preset.isSelected}\\\">\\n                <div class=\\\"preset-icon-image\\\">\\n                  <img src=\\\"{{btemplate.TOOL_ASSETS + preset.Icon}}\\\" class=\\\"preset-image\\\">\\n                </div>\\n                <span class=\\\"preset-label\\\">{{preset.Title}}</span>\\n              </button> --> <button class=\\\"preset-button tools-icon _inline-block\\\" ng-click=\\\"btemplate.onQuestion_clickHandler($event, preset, $index, question)\\\" ng-class={active:preset.isSelected}><div class=tools-icon-container><img ng-src=\\\"{{btemplate.TOOL_ASSETS + preset.Icon}}\\\" class=\\\"tools-icon-image _absolute\\\"></div><span class=preset-label>{{preset.Title}}</span></button></div></div></div></div><div class=\\\"row text-center\\\"><div class=\\\"col-sm-4 col-sm-offset-4 budget-template-create\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=submit>Create template</button></div><div class=\\\"col-sm-4 budget-skip-link\\\"><a class=font-orange ng-click=btemplate.onSkip_clickHandler($event)>SKIP <i class=\\\"fa fa-chevron-right font-xs\\\"></i></a><br></div></div></form></div></div>\");\n$templateCache.put(\"app/tool/tool.html\",\"<div ng-if=!tool.isReady><div class=layout-header-small><div class=header-small-container><div class=header-background style=\\\"background-image: url(themes/sorted/standalone/tools/budget-calculator/assets/images/header-background-tools.jpg)\\\"><div class=header-small-opacity></div></div><div style=\\\"position: relative; top:96px; z-index: 1000; width: 100%\\\"><div style=\\\"display: flex; justify-content: center; margin-top: 50px\\\"><img class=img-responsive src=themes/sorted/standalone/tools/budget-calculator/assets/images/Eclipse.svg></div><div class=text-center>loading data</div></div></div></div></div><div ng-if=tool.isReady><tool-header breadcrumbs=tool.breadcrumbs profiledata=tool.userProfileData imagepath=tool.imagePath budgetdata=tool.currentBudget></tool-header><print-view><div class=\\\"budget-breakdown-wrap breakdown-vertical\\\" style=\\\"position: relative !important\\\"><div class=budget-graph-wrap><div class=budget-breakdown-chart kendo-chart k-options=tool.chartOptions k-rebind=tool.chartOptions></div><div class=budget-breakdown-readable><div class=budget-breakdown-titles><h3 class=subtotal ng-bind-html=\\\"tool.currentBudget.MasterCategoriesTotalFormattedString | currency\\\"></h3><h5 class=subtotal-copy>Total budgeted</h5><p class=subtotal-period ng-bind-html=tool.currentBudget.Income.Period.Title></p></div><div class=budget-breakdown-legend><ul class=breakdown-master-categories><li ng-repeat=\\\"masterCategory in tool.currentBudget.MasterCategories\\\"><div class=inner-legend style=\\\"background-color:{{masterCategory.Color}} !important; -webkit-print-color-adjust: exact\\\"></div><div class=\\\"legend-label font-medium\\\" ng-bind-html=masterCategory.Title></div><div class=\\\"legend-amount font-medium\\\">{{masterCategory.PieValuePercent}}%</div></li></ul></div></div></div></div><div class=\\\"container-fluid budget-tool-container view-list\\\" ng-class=\\\"{\\'breakdown-reduce\\':tool.breakdownCollapse}\\\"><div class=budget-items-form-wrap><div class=budget-tool-rows><!-- NgRepeat a Master Category --><div class=budget-tool-row ng-repeat=\\\"masterCategory in tool.budgetData.MasterCategories\\\"><div class=budget-tool-master-category ng-class=\\\"{\\'master-category-open\\':masterCategory.DisplayOpen}\\\"><div class=budget-tool-master-category-inner><div class=\\\"master-category-icon pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"><img ng-if=\\\"masterCategory.Icon != \\'\\'\\\" ng-src=\\\"{{tool.TOOL_ASSETS + masterCategory.Icon}}\\\"><div style=\\\"display: flex; justify-content: center\\\" ng-if=\\\"masterCategory.Icon == \\'\\'\\\"><span style=\\\"background-color: {{masterCategory.Color}} !important; \\n                                    width: 30px;\\n                                    height: 30px;\\n                                    display: inline-block;\\n                                    border-radius: 50%;\\n                                    margin-top: 11px;\\n                                    -webkit-print-color-adjust: exact !important\\\"></span></div></div><div class=master-category-title modal-activator modal-type=edit_master_category data-mastercategory={{masterCategory}}><input modal-activator modal-type=edit_master_category type=text ng-model=masterCategory.Title readonly onfocus=this.blur()></div><div class=\\\"master-category-value pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"><input type=text ng-model=masterCategory.ValueFormattedString class=pointer readonly onfocus=this.blur()></div><div class=\\\"master-category-view-toggle pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"></div></div><!-- NgRepeat the Sub categories within this Master Category --><div class=categories-list-items><div ng-repeat=\\\"subCategory in masterCategory.SubCategories\\\" class=sub-category-item ng-class=\\\"{\\'category-state-edit\\':subCategory.stateEdit}\\\"><div class=cat-section-left><div class=sub-category-image modal-activator modal-type=add_subcategory data-subcategory={{subCategory}} data-mastercatindex={{$parent.$index}} data-catindex={{$index}} ng-style=\\\"{\\'background-image\\':\\'url(./\\'+ subCategory.Image+\\')\\'}\\\"><img class=orange-edit ng-src=\\\"{{tool.TOOL_ASSETS + \\'assets/images/edit-orange.svg\\'}}\\\"></div><div class=sub-category-title><input type=text ng-model=subCategory.Title ng-focus=\\\"tool.onSubCategoryTitle_focusInHandler($event, subCategory)\\\" ng-blur=\\\"tool.onSubCategoryTitle_focusOutHandler($event, subCategory)\\\" ng-keyup=tool.onSubCategoryTitle_keyUpHandler($event) prevent-input-zoom></div><div class=sub-category-value><input type=text ng-model=subCategory.ValueFormattedString ng-focus=\\\"tool.onSubCategoryValue_focusInHandler($event, subCategory)\\\" ng-blur=\\\"tool.onSubCategoryValue_focusOutHandler($event, subCategory)\\\" restrict-currency prevent-input-zoom></div><div class=\\\"sub-category-period budget-period\\\"><div class=dropdown uib-dropdown><button class=\\\"btn btn-default dropdown-toggle form-control\\\" type=button uib-dropdown-toggle aria-haspopup=true aria-expanded=true><span>{{subCategory.Period.Title}}</span> <i class=icon-chevron-down aria-hidden=true></i></button><ul class=dropdown-menu><li ng-repeat=\\\"period in tool.budgetPeriods\\\"><a class=dropdown-link ng-click=\\\"tool.onSetPeriod_clickHandler($event, period, subCategory)\\\">{{period.Title}}</a></li></ul></div></div></div><div class=cat-section-right><div class=sub-category-view-toggle><button class=btn-delete-category modal-activator modal-type=delete_subcategory data-subcategory={{subCategory}} data-mastercatindex={{$parent.$index}} data-catindex={{$index}}></button></div></div></div><!-- Add new sub category row --><div class=sub-category-item><button class=btn-sub-category-add modal-activator modal-type=add_subcategory data-mastercatindex={{$index}} data-mastercategory={{masterCategory}}>Add Category</button></div></div></div></div><!-- // Ideally this would be in the /components/popovers directory --><script type=text/ng-template id=addMasterCategoryPopover.html><button type=\\\"button\\\" class=\\\"popover-close-button btn btn-default\\\" ng-click=\\\"tool.onMasterCategoryCancel_clickHandler($event)\\\" aria-hidden=\\\"true\\\">×</button>\\n              <div class=\\\"container-fluid\\\">\\n                <div class=\\\"row\\\">\\n                  <div class=\\\"col-xs-12\\\">\\n                    <div class=\\\"form-group\\\">\\n                      <input type=\\\"text\\\" class=\\\"form-control\\\"\\n                                         placeholder=\\\"Add name\\\"\\n                                         autofocus=\\\"\\\"\\n                                         ng-model=\\\"tool.newMasterCategory.Title\\\"\\n                                         ng-keyup=\\\"tool.onMasterCategoryInput_keyUpHandler($event)\\\">\\n                    </div>\\n                  </div>\\n                </div>\\n                <div class=\\\"row\\\">\\n                  <div class=\\\"col-xs-6 text-center\\\">\\n                    <a class=\\\"font-orange\\\" ng-click=\\\"tool.onMasterCategoryCancel_clickHandler($event)\\\">CANCEL</a>\\n                  </div>\\n                  <div class=\\\"col-xs-6 text-center\\\">\\n                    <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"tool.onMasterCategorySave_clickHandler($event)\\\">OK</button>\\n                  </div>\\n                </div>\\n    \\n              </div></script><div class=budget-tool-row><div class=\\\"budget-tool-master-category-inner master-category-add\\\"><button class=btn-master-category-add popover-is-open=tool.newMasterCategory.PopoverOpen uib-popover-template=\\\"\\'addMasterCategoryPopover.html\\'\\\" popover-placement=top-left popover-class=add-master-category-popover type=button>Add Master Category</button><div class=\\\"tool-print-options-wrap pull-right\\\"><a href=javascript:window.print() class=\\\"ui-link budget-print-link arrow-right hide-for-mobile\\\">PRINT</a> <button ng-if=!tool.isLoggedIn data-toggle=modal data-target=#login-modal class=\\\"btn btn-primary btn-small ui-link\\\">SAVE</button> <button ng-if=tool.isLoggedIn class=\\\"btn btn-primary btn-small ui-link\\\" ng-click=tool.onSave_clickHandler($event)>SAVE</button></div></div></div></div></div></div></print-view><div class=\\\"container-fluid budget-tool-container hide-for-print\\\" ng-class=\\\"{\\'view-list\\':(tool.viewState == \\'list\\'), \\'view-grid\\':(tool.viewState == \\'grid\\'), \\'breakdown-reduce\\':tool.breakdownCollapse}\\\"><div class=budget-items-form-wrap><!-- Budget Breakdown Mobile START--><section class=breakdown-horizontal><div class=budget-breakdown-mobile-container><div class=budget-breakdown-mobile-heading><div class=budget-breakdown-icon-container><img class=budget-breakdown-icon src=/themes/sorted/assets/images/icon-breakdown.png></div><div class=budget-breakdown-mobile-title><p>Budget Breakdown</p></div><div ng-click=tool.onToggleMobileBudget_clickHandler($event) class=budget-breakdown-mobile-toggle ng-class=\\\"{\\'budget-breakdown-mobile-open\\':tool.showMobileBudget}\\\"></div></div><!-- Budget Breakdown Mobile Heading END --><div class=budget-breakdown-mobile-content><div ng-if=tool.showMobileBudget class=budget-graph-wrap><div class=budget-breakdown-chart kendo-chart k-options=tool.chartOptions k-rebind=tool.chartOptions></div><div class=budget-breakdown-readable><div class=budget-breakdown-titles><h3 class=subtotal ng-bind-html=\\\"tool.currentBudget.MasterCategoriesTotalFormattedString | currency\\\"></h3><h5 class=subtotal-copy>Total budgeted</h5><p class=subtotal-period ng-bind-html=tool.currentBudget.Income.Period.Title></p></div><div class=budget-breakdown-legend><ul class=breakdown-master-categories><li ng-repeat=\\\"masterCategory in tool.currentBudget.MasterCategories\\\"><div class=inner-legend ng-style=\\\"{\\'background-color\\': masterCategory.Color}\\\"></div><div class=\\\"legend-label font-medium\\\" ng-bind-html=masterCategory.Title></div><div class=\\\"legend-amount font-medium\\\">{{masterCategory.PieValuePercent}}%</div></li></ul></div></div></div></div><!-- Budget Breakdown Mobile Content END --></div><!-- Budget Breakdown Mobile Container END --></section><!-- Budget Breakdown Mobile END --><!-- Budget Tool header START --><div class=\\\"budget-view-chooser-container row\\\"><div class=\\\"budget-view-copy-container col-xs-3 col-xs-offset-5 col-sm-2 col-sm-offset-6 col-md-offset-5\\\">Budgeted</div><div class=\\\"col-xs-4 text-right pull-right\\\"><div class=\\\"budget-view-button-container text-left ng-scope\\\"><img class=budget-view-button ng-src=/themes/sorted/standalone/tools/budget-calculator/assets/images/grid.svg ng-class=\\\"{\\'selected\\': (tool.viewState == \\'grid\\')}\\\" ng-click=\\\"tool.onViewToggle_clickHandler($event, \\'grid\\')\\\" src=/themes/sorted/assets/images/tools/budgeting-tool/grid.svg></div><div class=\\\"budget-view-button-container text-left ng-scope\\\"><img class=\\\"budget-view-button selected\\\" ng-src=/themes/sorted/standalone/tools/budget-calculator/assets/images/list.svg ng-class=\\\"{\\'selected\\': (tool.viewState == \\'list\\')}\\\" ng-click=\\\"tool.onViewToggle_clickHandler($event, \\'list\\')\\\" src=/themes/sorted/assets/images/tools/budgeting-tool/list.svg></div></div></div><!-- Budget Tool header END --><div class=budget-tool-rows><!-- NgRepeat a Master Category --><div class=budget-tool-row ng-repeat=\\\"masterCategory in tool.budgetData.MasterCategories\\\"><div class=budget-tool-master-category ng-class=\\\"{\\'master-category-open\\':masterCategory.DisplayOpen}\\\"><div class=budget-tool-master-category-inner><div class=\\\"master-category-icon pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"><img ng-if=\\\"masterCategory.Icon != \\'\\'\\\" ng-src=\\\"{{tool.TOOL_ASSETS + masterCategory.Icon}}\\\"><div style=\\\"display: flex;\\n                              justify-content: center\\\" ng-if=\\\"masterCategory.Icon == \\'\\'\\\"><span style=\\\"background-color: {{masterCategory.Color}} !important;\\n                                  width: 30px !important;\\n                                  height: 30px !important;\\n                                  display: inline-block !important;\\n                                  border-radius: 50% !important;\\n                                  margin-top: 11px !important\\\"></span></div></div><div class=master-category-title modal-activator modal-type=edit_master_category data-mastercategory={{masterCategory}}><input modal-activator modal-type=edit_master_category type=text ng-model=masterCategory.Title readonly></div><div class=\\\"master-category-value pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"><input type=text ng-model=masterCategory.ValueFormattedString class=pointer readonly onfocus=this.blur()></div><div class=\\\"master-category-view-toggle pointer\\\" ng-click=\\\"tool.onMasterCategory_clickHandler($event, masterCategory)\\\"></div></div><!-- NgRepeat the Sub categories within this Master Category --><div class=categories-list-items><div ng-repeat=\\\"subCategory in masterCategory.SubCategories\\\" class=sub-category-item ng-class=\\\"{\\'category-state-edit\\':subCategory.stateEdit}\\\"><div class=cat-section-left><div class=sub-category-image modal-activator modal-type=add_subcategory data-subcategory={{subCategory}} data-mastercatindex={{$parent.$index}} data-catindex={{$index}} ng-style=\\\"{\\'background-image\\':\\'url(./\\'+ subCategory.Image+\\')\\'}\\\"><img class=orange-edit ng-src=\\\"{{tool.TOOL_ASSETS + \\'assets/images/edit-orange.svg\\'}}\\\"></div><div class=sub-category-title><input type=text ng-model=subCategory.Title ng-focus=\\\"tool.onSubCategoryTitle_focusInHandler($event, subCategory)\\\" ng-blur=\\\"tool.onSubCategoryTitle_focusOutHandler($event, subCategory)\\\" ng-keyup=tool.onSubCategoryTitle_keyUpHandler($event) prevent-input-zoom></div><div class=sub-category-value><input type=text ng-model=subCategory.ValueFormattedString ng-focus=\\\"tool.onSubCategoryValue_focusInHandler($event, subCategory)\\\" ng-blur=\\\"tool.onSubCategoryValue_focusOutHandler($event, subCategory)\\\" restrict-currency prevent-input-zoom></div><div class=\\\"sub-category-period budget-period\\\"><div class=dropdown uib-dropdown><button class=\\\"btn btn-default dropdown-toggle form-control\\\" type=button uib-dropdown-toggle aria-haspopup=true aria-expanded=true><span>{{subCategory.Period.Title}}</span> <i class=icon-chevron-down aria-hidden=true></i></button><ul class=dropdown-menu><li ng-repeat=\\\"period in tool.budgetPeriods\\\"><a class=dropdown-link ng-click=\\\"tool.onSetPeriod_clickHandler($event, period, subCategory)\\\">{{period.Title}}</a></li></ul></div></div></div><div class=cat-section-right><div class=sub-category-view-toggle><img src=/themes/sorted/standalone/tools/budget-calculator/assets/images/trash-grey.svg class=btn-delete-category modal-activator modal-type=delete_subcategory data-subcategory={{subCategory}} data-mastercatindex={{$parent.$index}} data-catindex={{$index}}></div></div></div><!-- Add new sub category row --><div class=sub-category-item><button class=btn-sub-category-add modal-activator modal-type=add_subcategory data-mastercatindex={{$index}} data-mastercategory={{masterCategory}}>Add Category</button></div></div></div></div><!-- // Ideally this would be in the /components/popovers directory --><script type=text/ng-template id=addMasterCategoryPopover.html><button type=\\\"button\\\" class=\\\"popover-close-button btn btn-default\\\" ng-click=\\\"tool.onMasterCategoryCancel_clickHandler($event)\\\" aria-hidden=\\\"true\\\">×</button>\\n            <div class=\\\"container-fluid\\\">\\n              <div class=\\\"row\\\">\\n                <div class=\\\"col-xs-12\\\">\\n                  <div class=\\\"form-group\\\">\\n                    <input type=\\\"text\\\" class=\\\"form-control\\\"\\n                            placeholder=\\\"Add name\\\" autofocus=\\\"\\\"\\n                            ng-model=\\\"tool.newMasterCategory.Title\\\"\\n                            ng-keyup=\\\"tool.onMasterCategoryInput_keyUpHandler($event)\\\"\\n                            prevent-input-zoom>\\n                  </div>\\n                </div>\\n              </div>\\n              <div class=\\\"row\\\">\\n                <div class=\\\"col-xs-6 text-center\\\">\\n                  <a class=\\\"font-orange\\\" ng-click=\\\"tool.onMasterCategoryCancel_clickHandler($event)\\\">CANCEL</a>\\n                </div>\\n                <div class=\\\"col-xs-6 text-center\\\">\\n                  <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"tool.onMasterCategorySave_clickHandler($event)\\\">OK</button>\\n                </div>\\n              </div>\\n    \\n            </div></script><div class=budget-tool-row><div class=\\\"budget-tool-master-category-inner master-category-add\\\"><button class=btn-master-category-add popover-is-open=tool.newMasterCategory.PopoverOpen uib-popover-template=\\\"\\'addMasterCategoryPopover.html\\'\\\" popover-placement=top-left popover-class=add-master-category-popover type=button>Add Master Category</button><div class=\\\"tool-print-options-wrap pull-right\\\"><a href=javascript:window.print() class=\\\"ui-link budget-print-link arrow-right hide-for-mobile\\\">PRINT</a> <button ng-if=!tool.isLoggedIn data-toggle=modal data-target=#login-modal class=\\\"btn btn-primary btn-small ui-link\\\">SAVE</button> <button ng-if=tool.isLoggedIn class=\\\"btn btn-primary btn-small ui-link\\\" ng-click=tool.onSave_clickHandler($event)>SAVE</button></div></div></div></div></div><!-- Budget Breakdown - Desktop --><div class=\\\"budget-breakdown-wrap breakdown-vertical\\\" id=main-breakdown-vertical><div class=left-bar><button class=btn-toggle-breakdownview ng-click=tool.onBreakdownToggle_clickHandler($event)><div class=\\\"icon reduce\\\"><span class=icon-chevron-left></span></div><div class=\\\"icon open\\\"><span class=icon-chevron-right></span></div><span class=button-label>Budget Breakdown</span></button></div><div class=budget-graph-wrap><div class=budget-breakdown-chart kendo-chart k-options=tool.chartOptions k-rebind=tool.chartOptions></div><div class=budget-breakdown-readable><div class=budget-breakdown-titles><h3 class=subtotal ng-bind-html=\\\"tool.currentBudget.MasterCategoriesTotalFormattedString | currency\\\"></h3><h5 class=subtotal-copy>Total budgeted</h5><p class=subtotal-period ng-bind-html=tool.currentBudget.Income.Period.Title></p></div><div class=budget-breakdown-legend><ul class=breakdown-master-categories><li ng-repeat=\\\"masterCategory in tool.currentBudget.MasterCategories\\\"><div class=inner-legend ng-style=\\\"{\\'background-color\\': masterCategory.Color}\\\"></div><div class=\\\"legend-label font-medium\\\" ng-bind-html=masterCategory.Title></div><div class=\\\"legend-amount font-medium\\\">{{masterCategory.PieValuePercent}}%</div></li></ul></div></div></div></div></div></div>\");\n$templateCache.put(\"app/welcome/welcome.html\",\"<intro-header data=welcome.data.Header breadcrumbs=welcome.breadcrumbs></intro-header><p ng-if=\\\"!welcome.isLoggedIn || vm.getProfile.getProfile()\\\" class=\\\"font-medium login-prompt\\\">Already got a budget? <a class=not-logged-in-link data-toggle=modal data-target=#login-modal>Log in here &gt;</a></p><div class=layout-container><div class=row><div class=\\\"budget-amount-form-container col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3\\\"><form name=budgetAmountForm><div class=form-group><label for=amount-to-budget>Amount to budget (income)</label><div class=row><div class=col-sm-8><div class=\\\"input-group form-inline-addon form-addon-dollar\\\"><input name=amount-to-budget id=amount-to-budget type=text class=\\\"budget-amount form-control\\\" required ng-model=welcome.budget.Cents placeholder=Amount restrict-currency prevent-input-zoom> <span class=\\\"help-block hidden\\\">Please enter a valid amount.</span></div></div><div class=\\\"col-sm-4 budget-period\\\"><div class=dropdown uib-dropdown><button class=\\\"btn btn-default dropdown-toggle form-control modal-only\\\" type=button uib-dropdown-toggle aria-haspopup=true aria-expanded=true><span>{{welcome.budget.Period.Title}}</span> <i class=icon-chevron-down aria-hidden=true></i></button><ul class=dropdown-menu><li ng-repeat=\\\"period in welcome.budgetPeriods\\\"><a class=dropdown-link ng-click=\\\"welcome.onSetPeriod_clickHandler($event, period)\\\">{{period.Title}}</a></li></ul></div></div></div></div><div class=row><div class=\\\"budget-next col-sm-6 col-sm-offset-3\\\"><button class=\\\"btn btn-primary form-control\\\" type=submit ng-click=welcome.next()>Next</button></div></div></form></div></div></div><div class=\\\"create-a-budget bg-green-gradient _relative\\\"><div class=\\\"_full-height-xs-above _relative\\\"><div class=layout-container><div class=\\\"row _relative _full-height-xs-above\\\"><div class=\\\"layout-col col-sm-4 _relative _full-height-xs-above\\\"><div class=\\\"row text-center\\\"><div class=\\\"col-xs-10 col-xs-offset-1\\\"><h2>Create a budget that keeps pace with your lifestyle</h2></div></div><div class=\\\"row text-center\\\"><div class=\\\"col-xs-10 col-xs-offset-1\\\"><p class=font-light>The quick and easy way to keep track of your spending.</p></div></div></div><div class=\\\"layout-col col-sm-8 _relative _full-height-xs-above\\\"><div class=device-image-container><img class=img-responsive ng-src={{welcome.TOOL_ASSETS}}assets/images/DEVICES.png></div></div></div></div></div></div>\");\n$templateCache.put(\"app/components/breadcrumbs/breadcrumbs.html\",\"<ol class=breadcrumb><li ng-repeat=\\\"crumb in breadcrumbs\\\"><a ng-href={{crumb.path}} ng-class=\\\"{\\'font-orange\\': !$last, active: $last}\\\">{{crumb.title}}</a></li></ol>\");\n$templateCache.put(\"app/components/intro-header/introHeader.html\",\"<div class=layout-header-small><div class=header-small-container><div class=header-background style=\\\"background-image: url({{vm.TOOL_ASSETS}}assets/images/header-background-tools.jpg)\\\"><div class=\\\"intro-header-icon-container center-block\\\"><img class=img-responsive ng-src={{vm.TOOL_ASSETS}}assets/images/tools-budgeting-tool.png></div></div><div class=header-small-opacity></div><breadcrumbs ng-if=breadcrumbs breadcrumbs=breadcrumbs></breadcrumbs></div></div><div class=\\\"row text-center\\\" ng-if=data.Title><div class=\\\"col-xs-8 col-xs-offset-2\\\"><h2>{{data.Title}}</h2></div></div><div class=\\\"row text-center\\\" ng-if=data.Content><div class=\\\"col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4\\\"><p class=\\\"intro-header-copy font-light\\\">{{data.Content}}</p></div></div>\");\n$templateCache.put(\"app/components/modals/addEditSubCategoryModal.html\",\"<div class=add-category-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>{{$ctrl.title}}</h4></div><div class=modal-body><div class=container-fluid><div class=row><div class=\\\"col-lg-12 text-center category-image-container\\\"><div class=category-image-wrap ng-if=\\\"$ctrl.newCategory.File || $ctrl.isLoggedIn\\\" ng-class=\\\"{\\'have-image\\' : $ctrl.newCategory.File, \\'have-not-image\\' : !$ctrl.newCategory.File }\\\"><div style=\\\"background-image: url(\\'{{$ctrl.newCategory.File}}\\');\\n                  background-position: 50%;\\n                  background-size: cover;\\n                  background-repeat: no-repeat\\\" ng-if=$ctrl.newCategory.File ng-src={{$ctrl.newCategory.File}} class=\\\"drop-image center-block\\\"></div><div ng-if=$ctrl.isLoggedIn class=\\\"category-image drop-box\\\" ngf-select ngf-model-invalid=$ctrl.errorFiles ng-model=$ctrl.files ngf-fix-orientation=true accept=\\\"\\'image/*\\'\\\" ngf-max-size=3MB><img ng-if=$ctrl.isLoggedIn class=\\\"budget-category-image-upload ng-scope\\\" src=https://sorted.org.nz/themes/sorted/assets/images/tools/budgeting-tool/upload.svg><div ng-if=$ctrl.isUploading class=progress style=\\\"width: 200px\\\"><div class=progress-bar role=progressbar aria-valuenow=70 aria-valuemin=0 aria-valuemax=100 style=width:{{$ctrl.uploadProgress}}%><span class=sr-only>70% Complete</span></div></div></div></div><!-- max file upload error --> <span ng-if=$ctrl.errorFiles.$errorMessages.maxSize class=text-danger>Your image must be less than 3 MB</span><div ng-if=$ctrl.isLoggedIn class=\\\"text-center font-orange\\\" style=\\\"margin-bottom: 10px; cursor: pointer\\\" ngf-select ngf-model-invalid=$ctrl.errorFiles ng-model=$ctrl.files ww ngf-fix-orientation=true accept=\\\"\\'image/*\\'\\\" ngf-max-size=3MB>Edit Photo &gt;</div><span ng-if=!$ctrl.isLoggedIn class=\\\"font-small register-prompt\\\">Register for a free account to upload your own image.</span></div><div ng-if=$ctrl.isLoggedIn class=image-modal-spacer></div><div class=\\\"col-md-8 col-md-offset-2 category-name-group text-right\\\"><input type=text class=\\\"budget-title form-control\\\" ng-model=$ctrl.newCategory.Title ng-keyup=$ctrl.onCategoryName_keyUpHandler($event) placeholder=\\\"Name your category\\\" prevent-input-zoom></div></div><div class=row><div class=\\\"col-sm-6 col-md-4 col-md-offset-2\\\"><div class=\\\"input-group form-inline-addon form-addon-dollar\\\"><input name=amount-to-budget id=amount-to-budget type=text class=\\\"budget-amount form-control\\\" required ng-model=$ctrl.budget placeholder=Amount restrict-currency prevent-input-zoom> <span class=\\\"help-block hidden\\\">Please enter a valid amount.</span></div></div><div class=\\\"col-sm-6 col-md-4 budget-period\\\"><div class=dropdown uib-dropdown><button class=\\\"btn btn-default dropdown-toggle form-control modal-only\\\" type=button uib-dropdown-toggle aria-haspopup=true aria-expanded=true><span>{{$ctrl.period.Title}}</span> <i class=icon-chevron-down aria-hidden=true></i></button><ul class=dropdown-menu><li ng-repeat=\\\"period in $ctrl.budgetPeriods\\\"><a class=dropdown-link ng-click=\\\"$ctrl.onSetPeriod_clickHandler($event, period)\\\">{{period.Title}}</a></li></ul></div></div></div><div class=row><div class=\\\"col-sm-12 col-md-offset-2 edit-cat-delete\\\"><span modal-activator ng-if=$ctrl.subcategoryData modal-type=delete_subcategory data-subcategory={{$ctrl.subcategoryData}} data-mastercategory={{$ctrl.mastercategoryData}} data-mastercatindex={{$ctrl.masterCategoryIndex}} data-catindex={{$ctrl.categoryIndex}} class=edit-subcategory-modal-delete-text><span class=\\\"fa-stack budget-trash\\\"><i class=\\\"fa fa-circle fa-stack-2x\\\" style=\\\"color: #b7b8ba\\\"></i> <i class=\\\"fa fa-trash fa-stack-1x fa-inverse\\\"></i> </span>Delete category</span></div></div></div></div></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-sm-6 modal-ok-button text-left\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button ng-click=$ctrl.onOk_clickHandler($event)>OK</button></div></div></div>\");\n$templateCache.put(\"app/components/modals/deleteMasterCategoryModal.html\",\"<div class=budget-header-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>Warning!</h4></div><div class=modal-body>Are you sure you want to delete this category?</div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-sm-6 modal-ok-button text-left\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button ng-click=$ctrl.onDelete_clickHandler($event)>DELETE</button></div></div></div></div>\");\n$templateCache.put(\"app/components/modals/deleteSubCategoryModal.html\",\"<div class=budget-header-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>Warning!</h4></div><div class=modal-body>Are you sure you want to delete this category?<br><h4>{{$ctrl.subCategoryTitle}}</h4></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-sm-6 modal-ok-button text-left\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button ng-click=$ctrl.onDelete_clickHandler($event)>DELETE</button></div></div></div></div>\");\n$templateCache.put(\"app/components/modals/editBudgetModal.html\",\"<div class=budget-header-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>Edit Budget</h4></div><div class=modal-body><div class=container-fluid><div class=row><!-- <div class=\\\"col-md-3\\\">\\n          <div class=\\\"profile-picture\\\">\\n            <img ng-src=\\\"{{$ctrl.TOOL_ASSETS + $ctrl.userProfileData.Profile.ImageSource}}\\\" />\\n          </div>\\n        </div> --><div class=\\\"budget-modal-user-avatar center-block text-center _relative col-md-3\\\"><div class=\\\"budget-header-user-avatar center-block text-center _relative profile-picture\\\" style=background-image:url({{$ctrl.userProfileData.Profile.ImageSource}})></div><div class=modal-edit-profile-link><!--<a class=\\\"font-orange\\\" ng-click=\\\"\\\">EDIT PROFILE <i class=\\\"fa fa-chevron-right font-xs\\\"></i> (todo)</a>--></div></div><div class=col-md-6><div class=form-group><label for=budget-title>Budget name:</label><input type=text id=budget-title class=\\\"budget-title form-control\\\" autofocus ng-model=$ctrl.budgetCalculator.Income.Title></div></div><div class=\\\"col-md-3 budget-period\\\"><label for=budget-period-dropdown>Budgeting period:</label><div class=dropdown uib-dropdown><button class=\\\"btn btn-default dropdown-toggle form-control modal-only\\\" id=budget-period-dropdown type=button uib-dropdown-toggle aria-haspopup=true aria-expanded=true><span>{{$ctrl.budgetCalculator.Income.Period.Title}}</span> <i class=icon-chevron-down aria-hidden=true></i></button><ul class=dropdown-menu><li ng-repeat=\\\"period in $ctrl.budgetPeriods\\\"><a class=dropdown-link ng-click=\\\"$ctrl.onSetBudgetPeriod_clickHandler($event, period)\\\">{{period.Title}}</a></li></ul></div></div></div><div class=row><div class=col-sm-12><label>Income streams:</label></div></div><!-- Loop through the income streams --><div class=\\\"row income-stream-group\\\" ng-repeat=\\\"stream in $ctrl.budgetCalculator.Income.Streams\\\"><div class=\\\"col-md-8 form-group income-stream-name-group\\\"><input type=text class=\\\"budget-title form-control\\\" ng-model=stream.Title placeholder=\\\"Income source\\\"></div><div class=col-md-3><div class=\\\"form-inline-addon form-addon-dollar\\\"><input type=text class=\\\"budget-title form-control\\\" ng-model=stream.CentsFormattedString placeholder=\\\"Amount to budget\\\" ng-blur=\\\"$ctrl.onUpdateStream_blurHandler($event, stream)\\\" restrict-currency></div></div><div class=\\\"col-sm-12 col-md-1\\\" ng-if=stream.Removable><button class=\\\"btn-income-stream-remove btn-wrap\\\" ng-click=\\\"$ctrl.onRemoveIncome_clickHandler($event, stream, $index)\\\"></button><label for=btn-income-stream-remove class=remove-income-label>Remove Income</label></div></div><!-- Add a new stream --><div class=row><div class=\\\"col-sm-12 col-md-8 remove-income-container\\\"><button class=btn-income-stream-add ng-click=$ctrl.onAddIncome_clickHandler($event)>Add Income</button></div><div class=\\\"col-sm-12 col-md-4 btn-wrap\\\"><h2 class=calculated-income-stream>${{$ctrl.budgetCalculator.Income.TotalFormattedString}}</h2><span class=budget-amount>Available to budget</span></div></div></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-sm-6 modal-ok-button\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button ng-click=$ctrl.onOk_clickHandler($event)>OK</button></div></div></div></div></div>\");\n$templateCache.put(\"app/components/modals/editMasterCatModal.html\",\"<div class=edit-master-cat-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=\\\"modal-title text-center\\\">Edit Master Category</h4></div><div class=modal-body><div class=container-fluid><div class=row><div class=col-md-12><p class=cat-icon-holder><img ng-if=\\\"$ctrl.icon != \\'\\'\\\" class=cat-icon ng-src={{$ctrl.iconSrc}}></p></div></div><div class=row><div class=col-md-12><div class=form-group><input type=text id=budget-title class=\\\"budget-title form-control\\\" autofocus ng-model=$ctrl.categoryTitle></div></div></div><div class=row><div class=\\\"col-md-12 trash-container\\\"><!--ng-click=\\\"$ctrl.onDelete_clickHandler($event)\\\"--> <span modal-activator modal-type=delete_master_category data-mastercategory={{$ctrl.categoryData}}><span class=\\\"fa-stack budget-trash\\\"><i class=\\\"fa fa-circle fa-stack-2x\\\"></i> <i class=\\\"fa fa-trash fa-stack-1x fa-inverse\\\"></i> </span>Delete master category</span></div></div><!--<div class=\\\"row\\\">--><!--<div class=\\\"col-md-3\\\">--><!--<div class=\\\"profile-picture\\\">--><!--</div>--><!--</div>--><!--<div class=\\\"col-md-6\\\">--><!--<div class=\\\"form-group\\\">--><!--<label for=\\\"budget-title\\\">Budget name:</label>--><!--<input type=\\\"text\\\" id=\\\"budget-title\\\" class=\\\"budget-title form-control\\\" autofocus=\\\"\\\" ng-model=\\\"$ctrl.budgetCalculator.Income.Title\\\">--><!--</div>--><!--</div>--><!--<div class=\\\"col-md-3 budget-period\\\">--><!--<label for=\\\"budget-period-dropdown\\\">Budgeting period:</label>--><!--<div class=\\\"dropdown\\\" uib-dropdown>--><!--<button class=\\\"btn btn-default dropdown-toggle form-control\\\"--><!--id=\\\"budget-period-dropdown\\\"--><!--type=\\\"button\\\"--><!--uib-dropdown-toggle--><!--aria-haspopup=\\\"true\\\"--><!--aria-expanded=\\\"true\\\"--><!--&gt;<span>{{$ctrl.budgetCalculator.Income.Period.Title}}</span>  <i class=\\\"icon-chevron-down\\\" aria-hidden=\\\"true\\\"></i></button>--><!--<ul class=\\\"dropdown-menu\\\">--><!--<li ng-repeat=\\\"period in $ctrl.budgetPeriods\\\">--><!--<a class=\\\"dropdown-link\\\" ng-click=\\\"$ctrl.onSetBudgetPeriod_clickHandler($event, period)\\\">{{period.Title}}</a>--><!--</li>--><!--</ul>--><!--</div>--><!--</div>--><!--</div>--><!--<div class=\\\"row\\\">--><!--<div class=\\\"col-sm-12\\\">--><!--<label>Income streams:</label>--><!--</div>--><!--</div>--><!-- Loop through the income streams --><!--<div class=\\\"row income-stream-group\\\" ng-repeat=\\\"stream in $ctrl.budgetCalculator.Income.Streams\\\">--><!--<div class=\\\"col-md-8\\\">--><!--<input type=\\\"text\\\" class=\\\"budget-title form-control\\\" ng-model=\\\"stream.Title\\\" placeholder=\\\"Income source\\\">--><!--</div>--><!--<div class=\\\"col-md-3\\\">--><!--<input type=\\\"text\\\" class=\\\"budget-title form-control\\\" ng-model=\\\"stream.CentsFormattedString\\\" placeholder=\\\"Amount to budget\\\" ng-blur=\\\"$ctrl.onUpdateStream_blurHandler($event, stream)\\\" restrict-currency>--><!--</div>--><!--<div class=\\\"col-md-1 btn-wrap\\\" ng-if=\\\"stream.Removable\\\">--><!--<button class=\\\"btn-income-stream-remove\\\" ng-click=\\\"$ctrl.onRemoveIncome_clickHandler($event, stream, $index)\\\"></button>--><!--</div>--><!--</div>--><!-- Add a new stream --><!--<div class=\\\"row\\\">--><!--<div class=\\\"col-sm-12 col-md-8\\\">--><!--<button class=\\\"btn-income-stream-add\\\" ng-click=\\\"$ctrl.onAddIncome_clickHandler($event)\\\">Add Income</button>--><!--</div>--><!--<div class=\\\"col-sm-12 col-md-4\\\">--><!--<h2 class=\\\"calculated-income-stream\\\" ng-bind-html=\\\"$ctrl.budgetCalculator.Income.TotalFormattedString | currency\\\"></h2>--><!--<span class=\\\"budget-amount\\\">Available to budget</span>--><!--</div>--><!--</div>--></div></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-sm-6 modal-ok-button text-left\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button ng-click=$ctrl.onOk_clickHandler($event)>OK</button></div></div></div></div>\");\n$templateCache.put(\"app/components/modals/multiBudgetModal.html\",\"<div class=budget-header-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>Warning!</h4></div><div class=modal-body><div class=row><div class=col-xs-12><p>It looks like you already have a budget saved on Sorted. You can only have one – would you like to overwrite?</p></div></div></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-sm-6 text-center\\\"><button class=\\\"btn btn-primary form-control\\\" type=button ng-click=$ctrl.onCancel_clickHandler()>KEEP EXISTING</button><p class=\\\"overwrite-confirm-button-copy font-sm ng-binding\\\">Keep my existing budget from {{$ctrl.editDate | date:\\'fullDate\\'}}</p><p></p></div><div class=\\\"col-sm-6 text-center\\\"><button class=\\\"btn btn-primary form-control\\\" type=button ng-click=$ctrl.onOverWrite_clickHandler()>OVERWRITE WITH NEW</button><p class=\\\"overwrite-confirm-button-copy font-sm\\\"><span class=font-medium>Overwrite</span> my existing budget</p></div></div></div></div>\");\n$templateCache.put(\"app/components/modals/timeoutModal.html\",\"<div class=budget-header-modal><div class=modal-header><button type=button class=\\\"modal-close-button btn btn-default\\\" ng-click=$ctrl.onCancel_clickHandler($event) aria-hidden=true>×</button><h4 class=modal-title>Warning!</h4></div><div class=modal-body><p>Hi there,</p><p>You\\'re working on a budget that hasn\\'t been saved yet. Log in or register for a free Sorted account to save your progress.</p></div><div class=\\\"modal-footer text-center\\\"><div class=row><div class=\\\"col-md-4 modal-cancel-link\\\"><a class=font-orange ng-click=$ctrl.onCancel_clickHandler($event)>CANCEL</a></div><div class=\\\"col-md-4 modal-ok-button text-center timeout-ok\\\"><button class=\\\"btn btn-primary btn-xs-fullwidth\\\" type=button data-toggle=modal data-target=#login-modal ng-click=$ctrl.onCancel_clickHandler($event)>LOGIN</button></div><div class=\\\"col-md-4 modal-cancel-link text-left\\\"><a class=font-orange data-toggle=modal data-target=#signup-modal ng-click=$ctrl.onCancel_clickHandler($event)>SIGN UP</a></div></div></div></div>\");\n$templateCache.put(\"app/components/toolHeader/toolHeader.html\",\"<div class=layout-header-small><div class=header-small-container><div class=header-background style=\\\"background-image: url({{vm.TOOL_ASSETS}}assets/images/header-background-tools.jpg)\\\"><div class=\\\"intro-header-icon-container center-block\\\" ng-if=\\\"data != undefined\\\"><img class=img-responsive ng-src={{vm.TOOL_ASSETS}}assets/images/tools-budgeting-tool.png></div></div><div class=header-small-opacity></div><breadcrumbs ng-if=breadcrumbs breadcrumbs=breadcrumbs></breadcrumbs></div></div><div class=\\\"container-fluid author-details-container\\\"><div class=\\\"row budget-header\\\"><div class=\\\"logo-container print-only\\\"><img ng-src={{vm.TOOL_ASSETS}}assets/images/tools-budgeting-tool.png></div><div class=\\\"col-md-2 profile-picture-wrap\\\"><div class=\\\"profile-picture center-block\\\" style=\\\"background: url({{vm.imagepath}});\\n            width: 150px;\\n            height: 150px;\\n            border-radius: 50%;\\n            background-position: 50%;\\n            background-size: cover\\\"></div></div><div class=\\\"col-md-4 tool-title-wrap\\\" modal-activator modal-type=edit_budget><h1 class=prompt-editable ng-bind-html=budgetdata.Income.Title></h1><p class=budget-period ng-bind-html=budgetdata.Income.Period.Title></p></div><div class=\\\"col-md-3 tool-budget-amount-wrap\\\" modal-activator modal-type=edit_budget><h2 class=heavy ng-bind-html=\\\"budgetdata.Income.LeftToBudget | currency\\\" ng-class=\\\"{\\'budget-exceeded\\' : (budgetdata.Income.LeftToBudget < 0) }\\\"></h2><p class=budget-amount-copy>Available to budget</p></div><div class=\\\"col-md-3 tool-print-options-wrap\\\"><div class=options-row><a href=javascript:window.print() class=\\\"ui-link budget-print-link arrow-right hide-for-mobile\\\">PRINT</a> <button ng-if=!vm.isLoggedIn() data-toggle=modal data-target=#login-modal class=\\\"btn btn-primary btn-small ui-link\\\">SAVE</button> <button ng-if=vm.isLoggedIn() class=\\\"btn btn-primary btn-small ui-link\\\" ng-click=vm.onSave_clickHandler($event)>SAVE</button></div><div class=options-row><a href=/how-these-calculators-work#budgeting-tool target=_blank id=how-this-tool-works class=font-book>How this tool works</a></div></div></div></div>\");}]);"],"sourceRoot":"/source/"}